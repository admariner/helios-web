var Dr=Object.defineProperty;var Ot=(e,t)=>{for(var n in t)Dr(e,n,{get:t[n],enumerable:!0})};var Ee={};Ot(Ee,{MODE:()=>Lr,NODE_ENV:()=>Pr,SSR:()=>Qr});var Lr="production",Pr="production",Qr=!1;var q=1e-6,U=typeof Float32Array!="undefined"?Float32Array:Array,Ut=Math.random;var wf=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function jt(){var e=new U(9);return U!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function qr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Or(e){var t=new U(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ur(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function jr(e,t,n,r,i,a,s,o,f){var l=new U(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=a,l[6]=s,l[7]=o,l[8]=f,l}function Gr(e,t,n,r,i,a,s,o,f,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=s,e[6]=o,e[7]=f,e[8]=l,e}function Yr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Hr(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Wr(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],f=t[6],l=t[7],h=t[8],c=h*s-o*l,u=-h*a+o*f,d=l*a-s*f,v=n*c+r*u+i*d;return v?(v=1/v,e[0]=c*v,e[1]=(-h*r+i*l)*v,e[2]=(o*r-i*s)*v,e[3]=u*v,e[4]=(h*n-i*f)*v,e[5]=(-o*n+i*a)*v,e[6]=d*v,e[7]=(-l*n+r*f)*v,e[8]=(s*n-r*a)*v,e):null}function Xr(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],f=t[6],l=t[7],h=t[8];return e[0]=s*h-o*l,e[1]=i*l-r*h,e[2]=r*o-i*s,e[3]=o*f-a*h,e[4]=n*h-i*f,e[5]=i*a-n*o,e[6]=a*l-s*f,e[7]=r*f-n*l,e[8]=n*s-r*a,e}function Vr(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],f=e[7],l=e[8];return t*(l*a-s*f)+n*(-l*i+s*o)+r*(f*i-a*o)}function Gt(e,t,n){var r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],f=t[5],l=t[6],h=t[7],c=t[8],u=n[0],d=n[1],v=n[2],m=n[3],p=n[4],w=n[5],M=n[6],I=n[7],x=n[8];return e[0]=u*r+d*s+v*l,e[1]=u*i+d*o+v*h,e[2]=u*a+d*f+v*c,e[3]=m*r+p*s+w*l,e[4]=m*i+p*o+w*h,e[5]=m*a+p*f+w*c,e[6]=M*r+I*s+x*l,e[7]=M*i+I*o+x*h,e[8]=M*a+I*f+x*c,e}function Zr(e,t,n){var r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],f=t[5],l=t[6],h=t[7],c=t[8],u=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=a,e[3]=s,e[4]=o,e[5]=f,e[6]=u*r+d*s+l,e[7]=u*i+d*o+h,e[8]=u*a+d*f+c,e}function Kr(e,t,n){var r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],f=t[5],l=t[6],h=t[7],c=t[8],u=Math.sin(n),d=Math.cos(n);return e[0]=d*r+u*s,e[1]=d*i+u*o,e[2]=d*a+u*f,e[3]=d*s-u*r,e[4]=d*o-u*i,e[5]=d*f-u*a,e[6]=l,e[7]=h,e[8]=c,e}function Jr(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function e0(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function t0(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function n0(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function r0(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function i0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=n+n,o=r+r,f=i+i,l=n*s,h=r*s,c=r*o,u=i*s,d=i*o,v=i*f,m=a*s,p=a*o,w=a*f;return e[0]=1-c-v,e[3]=h-w,e[6]=u+p,e[1]=h+w,e[4]=1-l-v,e[7]=d-m,e[2]=u-p,e[5]=d+m,e[8]=1-l-c,e}function a0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],f=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],v=t[12],m=t[13],p=t[14],w=t[15],M=n*o-r*s,I=n*f-i*s,x=n*l-a*s,_=r*f-i*o,E=r*l-a*o,F=i*l-a*f,R=h*m-c*v,S=h*p-u*v,N=h*w-d*v,$=c*p-u*m,L=c*w-d*m,C=u*w-d*p,A=M*C-I*L+x*$+_*N-E*S+F*R;return A?(A=1/A,e[0]=(o*C-f*L+l*$)*A,e[1]=(f*N-s*C-l*S)*A,e[2]=(s*L-o*N+l*R)*A,e[3]=(i*L-r*C-a*$)*A,e[4]=(n*C-i*N+a*S)*A,e[5]=(r*N-n*L-a*R)*A,e[6]=(m*F-p*E+w*_)*A,e[7]=(p*x-v*F-w*I)*A,e[8]=(v*E-m*x+w*M)*A,e):null}function s0(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function o0(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function l0(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function f0(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function Yt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function h0(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function c0(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function u0(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function d0(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],f=e[6],l=e[7],h=e[8],c=t[0],u=t[1],d=t[2],v=t[3],m=t[4],p=t[5],w=t[6],M=t[7],I=t[8];return Math.abs(n-c)<=q*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-u)<=q*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-d)<=q*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-v)<=q*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=q*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(o-p)<=q*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(f-w)<=q*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(l-M)<=q*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(h-I)<=q*Math.max(1,Math.abs(h),Math.abs(I))}var v0=Gt,g0=Yt,ct=Object.freeze({__proto__:null,create:jt,fromMat4:qr,clone:Or,copy:Ur,fromValues:jr,set:Gr,identity:Yr,transpose:Hr,invert:Wr,adjoint:Xr,determinant:Vr,multiply:Gt,translate:Zr,rotate:Kr,scale:Jr,fromTranslation:e0,fromRotation:t0,fromScaling:n0,fromMat2d:r0,fromQuat:i0,normalFromMat4:a0,projection:s0,str:o0,frob:l0,add:f0,subtract:Yt,multiplyScalar:h0,multiplyScalarAndAdd:c0,exactEquals:u0,equals:d0,mul:v0,sub:g0});function p0(){var e=new U(16);return U!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function m0(e){var t=new U(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function A0(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function y0(e,t,n,r,i,a,s,o,f,l,h,c,u,d,v,m){var p=new U(16);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=i,p[5]=a,p[6]=s,p[7]=o,p[8]=f,p[9]=l,p[10]=h,p[11]=c,p[12]=u,p[13]=d,p[14]=v,p[15]=m,p}function w0(e,t,n,r,i,a,s,o,f,l,h,c,u,d,v,m,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=s,e[6]=o,e[7]=f,e[8]=l,e[9]=h,e[10]=c,e[11]=u,e[12]=d,e[13]=v,e[14]=m,e[15]=p,e}function Ht(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x0(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],s=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=s,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function _0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],f=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],v=t[12],m=t[13],p=t[14],w=t[15],M=n*o-r*s,I=n*f-i*s,x=n*l-a*s,_=r*f-i*o,E=r*l-a*o,F=i*l-a*f,R=h*m-c*v,S=h*p-u*v,N=h*w-d*v,$=c*p-u*m,L=c*w-d*m,C=u*w-d*p,A=M*C-I*L+x*$+_*N-E*S+F*R;return A?(A=1/A,e[0]=(o*C-f*L+l*$)*A,e[1]=(i*L-r*C-a*$)*A,e[2]=(m*F-p*E+w*_)*A,e[3]=(u*E-c*F-d*_)*A,e[4]=(f*N-s*C-l*S)*A,e[5]=(n*C-i*N+a*S)*A,e[6]=(p*x-v*F-w*I)*A,e[7]=(h*F-u*x+d*I)*A,e[8]=(s*L-o*N+l*R)*A,e[9]=(r*N-n*L-a*R)*A,e[10]=(v*E-m*x+w*M)*A,e[11]=(c*x-h*E-d*M)*A,e[12]=(o*S-s*$-f*R)*A,e[13]=(n*$-r*S+i*R)*A,e[14]=(m*I-v*_-p*M)*A,e[15]=(h*_-c*I+u*M)*A,e):null}function b0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],f=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],v=t[12],m=t[13],p=t[14],w=t[15];return e[0]=o*(u*w-d*p)-c*(f*w-l*p)+m*(f*d-l*u),e[1]=-(r*(u*w-d*p)-c*(i*w-a*p)+m*(i*d-a*u)),e[2]=r*(f*w-l*p)-o*(i*w-a*p)+m*(i*l-a*f),e[3]=-(r*(f*d-l*u)-o*(i*d-a*u)+c*(i*l-a*f)),e[4]=-(s*(u*w-d*p)-h*(f*w-l*p)+v*(f*d-l*u)),e[5]=n*(u*w-d*p)-h*(i*w-a*p)+v*(i*d-a*u),e[6]=-(n*(f*w-l*p)-s*(i*w-a*p)+v*(i*l-a*f)),e[7]=n*(f*d-l*u)-s*(i*d-a*u)+h*(i*l-a*f),e[8]=s*(c*w-d*m)-h*(o*w-l*m)+v*(o*d-l*c),e[9]=-(n*(c*w-d*m)-h*(r*w-a*m)+v*(r*d-a*c)),e[10]=n*(o*w-l*m)-s*(r*w-a*m)+v*(r*l-a*o),e[11]=-(n*(o*d-l*c)-s*(r*d-a*c)+h*(r*l-a*o)),e[12]=-(s*(c*p-u*m)-h*(o*p-f*m)+v*(o*u-f*c)),e[13]=n*(c*p-u*m)-h*(r*p-i*m)+v*(r*u-i*c),e[14]=-(n*(o*p-f*m)-s*(r*p-i*m)+v*(r*f-i*o)),e[15]=n*(o*u-f*c)-s*(r*u-i*c)+h*(r*f-i*o),e}function M0(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],f=e[7],l=e[8],h=e[9],c=e[10],u=e[11],d=e[12],v=e[13],m=e[14],p=e[15],w=t*s-n*a,M=t*o-r*a,I=t*f-i*a,x=n*o-r*s,_=n*f-i*s,E=r*f-i*o,F=l*v-h*d,R=l*m-c*d,S=l*p-u*d,N=h*m-c*v,$=h*p-u*v,L=c*p-u*m;return w*L-M*$+I*N+x*S-_*R+E*F}function Wt(e,t,n){var r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],f=t[5],l=t[6],h=t[7],c=t[8],u=t[9],d=t[10],v=t[11],m=t[12],p=t[13],w=t[14],M=t[15],I=n[0],x=n[1],_=n[2],E=n[3];return e[0]=I*r+x*o+_*c+E*m,e[1]=I*i+x*f+_*u+E*p,e[2]=I*a+x*l+_*d+E*w,e[3]=I*s+x*h+_*v+E*M,I=n[4],x=n[5],_=n[6],E=n[7],e[4]=I*r+x*o+_*c+E*m,e[5]=I*i+x*f+_*u+E*p,e[6]=I*a+x*l+_*d+E*w,e[7]=I*s+x*h+_*v+E*M,I=n[8],x=n[9],_=n[10],E=n[11],e[8]=I*r+x*o+_*c+E*m,e[9]=I*i+x*f+_*u+E*p,e[10]=I*a+x*l+_*d+E*w,e[11]=I*s+x*h+_*v+E*M,I=n[12],x=n[13],_=n[14],E=n[15],e[12]=I*r+x*o+_*c+E*m,e[13]=I*i+x*f+_*u+E*p,e[14]=I*a+x*l+_*d+E*w,e[15]=I*s+x*h+_*v+E*M,e}function I0(e,t,n){var r=n[0],i=n[1],a=n[2],s,o,f,l,h,c,u,d,v,m,p,w;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*a+t[12],e[13]=t[1]*r+t[5]*i+t[9]*a+t[13],e[14]=t[2]*r+t[6]*i+t[10]*a+t[14],e[15]=t[3]*r+t[7]*i+t[11]*a+t[15]):(s=t[0],o=t[1],f=t[2],l=t[3],h=t[4],c=t[5],u=t[6],d=t[7],v=t[8],m=t[9],p=t[10],w=t[11],e[0]=s,e[1]=o,e[2]=f,e[3]=l,e[4]=h,e[5]=c,e[6]=u,e[7]=d,e[8]=v,e[9]=m,e[10]=p,e[11]=w,e[12]=s*r+h*i+v*a+t[12],e[13]=o*r+c*i+m*a+t[13],e[14]=f*r+u*i+p*a+t[14],e[15]=l*r+d*i+w*a+t[15]),e}function E0(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function B0(e,t,n,r){var i=r[0],a=r[1],s=r[2],o=Math.hypot(i,a,s),f,l,h,c,u,d,v,m,p,w,M,I,x,_,E,F,R,S,N,$,L,C,A,g;return o<q?null:(o=1/o,i*=o,a*=o,s*=o,f=Math.sin(n),l=Math.cos(n),h=1-l,c=t[0],u=t[1],d=t[2],v=t[3],m=t[4],p=t[5],w=t[6],M=t[7],I=t[8],x=t[9],_=t[10],E=t[11],F=i*i*h+l,R=a*i*h+s*f,S=s*i*h-a*f,N=i*a*h-s*f,$=a*a*h+l,L=s*a*h+i*f,C=i*s*h+a*f,A=a*s*h-i*f,g=s*s*h+l,e[0]=c*F+m*R+I*S,e[1]=u*F+p*R+x*S,e[2]=d*F+w*R+_*S,e[3]=v*F+M*R+E*S,e[4]=c*N+m*$+I*L,e[5]=u*N+p*$+x*L,e[6]=d*N+w*$+_*L,e[7]=v*N+M*$+E*L,e[8]=c*C+m*A+I*g,e[9]=u*C+p*A+x*g,e[10]=d*C+w*A+_*g,e[11]=v*C+M*A+E*g,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function C0(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],s=t[5],o=t[6],f=t[7],l=t[8],h=t[9],c=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*r,e[5]=s*i+h*r,e[6]=o*i+c*r,e[7]=f*i+u*r,e[8]=l*i-a*r,e[9]=h*i-s*r,e[10]=c*i-o*r,e[11]=u*i-f*r,e}function k0(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],s=t[1],o=t[2],f=t[3],l=t[8],h=t[9],c=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*r,e[1]=s*i-h*r,e[2]=o*i-c*r,e[3]=f*i-u*r,e[8]=a*r+l*i,e[9]=s*r+h*i,e[10]=o*r+c*i,e[11]=f*r+u*i,e}function R0(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],s=t[1],o=t[2],f=t[3],l=t[4],h=t[5],c=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*r,e[1]=s*i+h*r,e[2]=o*i+c*r,e[3]=f*i+u*r,e[4]=l*i-a*r,e[5]=h*i-s*r,e[6]=c*i-o*r,e[7]=u*i-f*r,e}function F0(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function S0(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function N0(e,t,n){var r=n[0],i=n[1],a=n[2],s=Math.hypot(r,i,a),o,f,l;return s<q?null:(s=1/s,r*=s,i*=s,a*=s,o=Math.sin(t),f=Math.cos(t),l=1-f,e[0]=r*r*l+f,e[1]=i*r*l+a*o,e[2]=a*r*l-i*o,e[3]=0,e[4]=r*i*l-a*o,e[5]=i*i*l+f,e[6]=a*i*l+r*o,e[7]=0,e[8]=r*a*l+i*o,e[9]=i*a*l-r*o,e[10]=a*a*l+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function $0(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function z0(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function T0(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Xt(e,t,n){var r=t[0],i=t[1],a=t[2],s=t[3],o=r+r,f=i+i,l=a+a,h=r*o,c=r*f,u=r*l,d=i*f,v=i*l,m=a*l,p=s*o,w=s*f,M=s*l;return e[0]=1-(d+m),e[1]=c+M,e[2]=u-w,e[3]=0,e[4]=c-M,e[5]=1-(h+m),e[6]=v+p,e[7]=0,e[8]=u+w,e[9]=v-p,e[10]=1-(h+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function D0(e,t){var n=new U(3),r=-t[0],i=-t[1],a=-t[2],s=t[3],o=t[4],f=t[5],l=t[6],h=t[7],c=r*r+i*i+a*a+s*s;return c>0?(n[0]=(o*s+h*r+f*a-l*i)*2/c,n[1]=(f*s+h*i+l*r-o*a)*2/c,n[2]=(l*s+h*a+o*i-f*r)*2/c):(n[0]=(o*s+h*r+f*a-l*i)*2,n[1]=(f*s+h*i+l*r-o*a)*2,n[2]=(l*s+h*a+o*i-f*r)*2),Xt(e,t,n),e}function L0(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Vt(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],s=t[5],o=t[6],f=t[8],l=t[9],h=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(a,s,o),e[2]=Math.hypot(f,l,h),e}function P0(e,t){var n=new U(3);Vt(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],s=t[0]*r,o=t[1]*i,f=t[2]*a,l=t[4]*r,h=t[5]*i,c=t[6]*a,u=t[8]*r,d=t[9]*i,v=t[10]*a,m=s+h+v,p=0;return m>0?(p=Math.sqrt(m+1)*2,e[3]=.25*p,e[0]=(c-d)/p,e[1]=(u-f)/p,e[2]=(o-l)/p):s>h&&s>v?(p=Math.sqrt(1+s-h-v)*2,e[3]=(c-d)/p,e[0]=.25*p,e[1]=(o+l)/p,e[2]=(u+f)/p):h>v?(p=Math.sqrt(1+h-s-v)*2,e[3]=(u-f)/p,e[0]=(o+l)/p,e[1]=.25*p,e[2]=(c+d)/p):(p=Math.sqrt(1+v-s-h)*2,e[3]=(o-l)/p,e[0]=(u+f)/p,e[1]=(c+d)/p,e[2]=.25*p),e}function Q0(e,t,n,r){var i=t[0],a=t[1],s=t[2],o=t[3],f=i+i,l=a+a,h=s+s,c=i*f,u=i*l,d=i*h,v=a*l,m=a*h,p=s*h,w=o*f,M=o*l,I=o*h,x=r[0],_=r[1],E=r[2];return e[0]=(1-(v+p))*x,e[1]=(u+I)*x,e[2]=(d-M)*x,e[3]=0,e[4]=(u-I)*_,e[5]=(1-(c+p))*_,e[6]=(m+w)*_,e[7]=0,e[8]=(d+M)*E,e[9]=(m-w)*E,e[10]=(1-(c+v))*E,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function q0(e,t,n,r,i){var a=t[0],s=t[1],o=t[2],f=t[3],l=a+a,h=s+s,c=o+o,u=a*l,d=a*h,v=a*c,m=s*h,p=s*c,w=o*c,M=f*l,I=f*h,x=f*c,_=r[0],E=r[1],F=r[2],R=i[0],S=i[1],N=i[2],$=(1-(m+w))*_,L=(d+x)*_,C=(v-I)*_,A=(d-x)*E,g=(1-(u+w))*E,y=(p+M)*E,b=(v+I)*F,B=(p-M)*F,k=(1-(u+m))*F;return e[0]=$,e[1]=L,e[2]=C,e[3]=0,e[4]=A,e[5]=g,e[6]=y,e[7]=0,e[8]=b,e[9]=B,e[10]=k,e[11]=0,e[12]=n[0]+R-($*R+A*S+b*N),e[13]=n[1]+S-(L*R+g*S+B*N),e[14]=n[2]+N-(C*R+y*S+k*N),e[15]=1,e}function O0(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=n+n,o=r+r,f=i+i,l=n*s,h=r*s,c=r*o,u=i*s,d=i*o,v=i*f,m=a*s,p=a*o,w=a*f;return e[0]=1-c-v,e[1]=h+w,e[2]=u-p,e[3]=0,e[4]=h-w,e[5]=1-l-v,e[6]=d+m,e[7]=0,e[8]=u+p,e[9]=d-m,e[10]=1-l-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function U0(e,t,n,r,i,a,s){var o=1/(n-t),f=1/(i-r),l=1/(a-s);return e[0]=a*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*f,e[6]=0,e[7]=0,e[8]=(n+t)*o,e[9]=(i+r)*f,e[10]=(s+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*a*2*l,e[15]=0,e}function j0(e,t,n,r,i){var a=1/Math.tan(t/2),s;return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==Infinity?(s=1/(r-i),e[10]=(i+r)*s,e[14]=2*i*r*s):(e[10]=-1,e[14]=-2*r),e}function G0(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),f=2/(s+o),l=2/(i+a);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((s-o)*f*.5),e[9]=(i-a)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Y0(e,t,n,r,i,a,s){var o=1/(t-n),f=1/(r-i),l=1/(a-s);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*o,e[13]=(i+r)*f,e[14]=(s+a)*l,e[15]=1,e}function H0(e,t,n,r){var i,a,s,o,f,l,h,c,u,d,v=t[0],m=t[1],p=t[2],w=r[0],M=r[1],I=r[2],x=n[0],_=n[1],E=n[2];return Math.abs(v-x)<q&&Math.abs(m-_)<q&&Math.abs(p-E)<q?Ht(e):(h=v-x,c=m-_,u=p-E,d=1/Math.hypot(h,c,u),h*=d,c*=d,u*=d,i=M*u-I*c,a=I*h-w*u,s=w*c-M*h,d=Math.hypot(i,a,s),d?(d=1/d,i*=d,a*=d,s*=d):(i=0,a=0,s=0),o=c*s-u*a,f=u*i-h*s,l=h*a-c*i,d=Math.hypot(o,f,l),d?(d=1/d,o*=d,f*=d,l*=d):(o=0,f=0,l=0),e[0]=i,e[1]=o,e[2]=h,e[3]=0,e[4]=a,e[5]=f,e[6]=c,e[7]=0,e[8]=s,e[9]=l,e[10]=u,e[11]=0,e[12]=-(i*v+a*m+s*p),e[13]=-(o*v+f*m+l*p),e[14]=-(h*v+c*m+u*p),e[15]=1,e)}function W0(e,t,n,r){var i=t[0],a=t[1],s=t[2],o=r[0],f=r[1],l=r[2],h=i-n[0],c=a-n[1],u=s-n[2],d=h*h+c*c+u*u;d>0&&(d=1/Math.sqrt(d),h*=d,c*=d,u*=d);var v=f*u-l*c,m=l*h-o*u,p=o*c-f*h;return d=v*v+m*m+p*p,d>0&&(d=1/Math.sqrt(d),v*=d,m*=d,p*=d),e[0]=v,e[1]=m,e[2]=p,e[3]=0,e[4]=c*p-u*m,e[5]=u*v-h*p,e[6]=h*m-c*v,e[7]=0,e[8]=h,e[9]=c,e[10]=u,e[11]=0,e[12]=i,e[13]=a,e[14]=s,e[15]=1,e}function X0(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function V0(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Z0(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Zt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function K0(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function J0(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function ei(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function ti(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],f=e[6],l=e[7],h=e[8],c=e[9],u=e[10],d=e[11],v=e[12],m=e[13],p=e[14],w=e[15],M=t[0],I=t[1],x=t[2],_=t[3],E=t[4],F=t[5],R=t[6],S=t[7],N=t[8],$=t[9],L=t[10],C=t[11],A=t[12],g=t[13],y=t[14],b=t[15];return Math.abs(n-M)<=q*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(r-I)<=q*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(i-x)<=q*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-_)<=q*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-E)<=q*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(o-F)<=q*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(f-R)<=q*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(l-S)<=q*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-N)<=q*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(c-$)<=q*Math.max(1,Math.abs(c),Math.abs($))&&Math.abs(u-L)<=q*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(d-C)<=q*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(v-A)<=q*Math.max(1,Math.abs(v),Math.abs(A))&&Math.abs(m-g)<=q*Math.max(1,Math.abs(m),Math.abs(g))&&Math.abs(p-y)<=q*Math.max(1,Math.abs(p),Math.abs(y))&&Math.abs(w-b)<=q*Math.max(1,Math.abs(w),Math.abs(b))}var ni=Wt,ri=Zt,G=Object.freeze({__proto__:null,create:p0,clone:m0,copy:A0,fromValues:y0,set:w0,identity:Ht,transpose:x0,invert:_0,adjoint:b0,determinant:M0,multiply:Wt,translate:I0,scale:E0,rotate:B0,rotateX:C0,rotateY:k0,rotateZ:R0,fromTranslation:F0,fromScaling:S0,fromRotation:N0,fromXRotation:$0,fromYRotation:z0,fromZRotation:T0,fromRotationTranslation:Xt,fromQuat2:D0,getTranslation:L0,getScaling:Vt,getRotation:P0,fromRotationTranslationScale:Q0,fromRotationTranslationScaleOrigin:q0,fromQuat:O0,frustum:U0,perspective:j0,perspectiveFromFieldOfView:G0,ortho:Y0,lookAt:H0,targetTo:W0,str:X0,frob:V0,add:Z0,subtract:Zt,multiplyScalar:K0,multiplyScalarAndAdd:J0,exactEquals:ei,equals:ti,mul:ni,sub:ri});function ut(){var e=new U(3);return U!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ii(e){var t=new U(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Kt(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function dt(e,t,n){var r=new U(3);return r[0]=e,r[1]=t,r[2]=n,r}function ai(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function si(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function oi(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Jt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function en(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function tn(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function li(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function fi(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function hi(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function ci(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function ui(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function di(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function vi(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function nn(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function rn(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function an(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function gi(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function pi(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function sn(e,t){var n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function vt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Le(e,t,n){var r=t[0],i=t[1],a=t[2],s=n[0],o=n[1],f=n[2];return e[0]=i*f-a*o,e[1]=a*s-r*f,e[2]=r*o-i*s,e}function mi(e,t,n,r){var i=t[0],a=t[1],s=t[2];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=s+r*(n[2]-s),e}function Ai(e,t,n,r,i,a){var s=a*a,o=s*(2*a-3)+1,f=s*(a-2)+a,l=s*(a-1),h=s*(3-2*a);return e[0]=t[0]*o+n[0]*f+r[0]*l+i[0]*h,e[1]=t[1]*o+n[1]*f+r[1]*l+i[1]*h,e[2]=t[2]*o+n[2]*f+r[2]*l+i[2]*h,e}function yi(e,t,n,r,i,a){var s=1-a,o=s*s,f=a*a,l=o*s,h=3*a*o,c=3*f*s,u=f*a;return e[0]=t[0]*l+n[0]*h+r[0]*c+i[0]*u,e[1]=t[1]*l+n[1]*h+r[1]*c+i[1]*u,e[2]=t[2]*l+n[2]*h+r[2]*c+i[2]*u,e}function wi(e,t){t=t||1;var n=Ut()*2*Math.PI,r=Ut()*2-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function xi(e,t,n){var r=t[0],i=t[1],a=t[2],s=n[3]*r+n[7]*i+n[11]*a+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/s,e[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/s,e}function _i(e,t,n){var r=t[0],i=t[1],a=t[2];return e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8],e}function bi(e,t,n){var r=n[0],i=n[1],a=n[2],s=n[3],o=t[0],f=t[1],l=t[2],h=i*l-a*f,c=a*o-r*l,u=r*f-i*o,d=i*u-a*c,v=a*h-r*u,m=r*c-i*h,p=s*2;return h*=p,c*=p,u*=p,d*=2,v*=2,m*=2,e[0]=o+h+d,e[1]=f+c+v,e[2]=l+u+m,e}function Mi(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Ii(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Ei(e,t,n,r){var i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Bi(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],s=t[1],o=t[2],f=Math.sqrt(n*n+r*r+i*i),l=Math.sqrt(a*a+s*s+o*o),h=f*l,c=h&&vt(e,t)/h;return Math.acos(Math.min(Math.max(c,-1),1))}function Ci(e){return e[0]=0,e[1]=0,e[2]=0,e}function ki(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ri(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Fi(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],s=t[1],o=t[2];return Math.abs(n-a)<=q*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=q*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-o)<=q*Math.max(1,Math.abs(i),Math.abs(o))}var Si=Jt,Ni=en,$i=tn,zi=nn,Ti=rn,on=Kt,Di=an,Li=function(){var e=ut();return function(t,n,r,i,a,s){var o,f;for(n||(n=3),r||(r=0),i?f=Math.min(i*n+r,t.length):f=t.length,o=r;o<f;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],a(e,e,s),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}(),ln=Object.freeze({__proto__:null,create:ut,clone:ii,length:Kt,fromValues:dt,copy:ai,set:si,add:oi,subtract:Jt,multiply:en,divide:tn,ceil:li,floor:fi,min:hi,max:ci,round:ui,scale:di,scaleAndAdd:vi,distance:nn,squaredDistance:rn,squaredLength:an,negate:gi,inverse:pi,normalize:sn,dot:vt,cross:Le,lerp:mi,hermite:Ai,bezier:yi,random:wi,transformMat4:xi,transformMat3:_i,transformQuat:bi,rotateX:Mi,rotateY:Ii,rotateZ:Ei,angle:Bi,zero:Ci,str:ki,exactEquals:Ri,equals:Fi,sub:Si,mul:Ni,div:$i,dist:zi,sqrDist:Ti,len:on,sqrLen:Di,forEach:Li});function Pi(){var e=new U(4);return U!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Qi(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],s=n*n+r*r+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=a*s,e}var xf=function(){var e=Pi();return function(t,n,r,i,a,s){var o,f;for(n||(n=4),r||(r=0),i?f=Math.min(i*n+r,t.length):f=t.length,o=r;o<f;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],a(e,e,s),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function fn(){var e=new U(4);return U!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function qi(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function gt(e,t,n,r){var i=t[0],a=t[1],s=t[2],o=t[3],f=n[0],l=n[1],h=n[2],c=n[3],u,d,v,m,p;return d=i*f+a*l+s*h+o*c,d<0&&(d=-d,f=-f,l=-l,h=-h,c=-c),1-d>q?(u=Math.acos(d),v=Math.sin(u),m=Math.sin((1-r)*u)/v,p=Math.sin(r*u)/v):(m=1-r,p=r),e[0]=m*i+p*f,e[1]=m*a+p*l,e[2]=m*s+p*h,e[3]=m*o+p*c,e}function Oi(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[a*3+a]-t[s*3+s]+1),e[i]=.5*r,r=.5/r,e[3]=(t[a*3+s]-t[s*3+a])*r,e[a]=(t[a*3+i]+t[i*3+a])*r,e[s]=(t[s*3+i]+t[i*3+s])*r}return e}var hn=Qi;var _f=function(){var e=ut(),t=dt(1,0,0),n=dt(0,1,0);return function(r,i,a){var s=vt(i,a);return s<-.999999?(Le(e,t,i),on(e)<1e-6&&Le(e,n,i),sn(e,e),qi(r,e,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Le(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+s,hn(r,r))}}(),bf=function(){var e=fn(),t=fn();return function(n,r,i,a,s,o){return gt(e,r,s,o),gt(t,i,a,o),gt(n,e,t,2*o*(1-o)),n}}(),Mf=function(){var e=jt();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],hn(t,Oi(t,e))}}();function Ui(){var e=new U(2);return U!=Float32Array&&(e[0]=0,e[1]=0),e}var If=function(){var e=Ui();return function(t,n,r,i,a,s){var o,f;for(n||(n=2),r||(r=0),i?f=Math.min(i*n+r,t.length):f=t.length,o=r;o<f;o+=n)e[0]=t[o],e[1]=t[o+1],a(e,e,s),t[o]=e[0],t[o+1]=e[1];return t}}();function pt(e,t,n,r){if(r<=n)return n;let i=Math.floor(n+(r-n)/2),a=t-e[i].value,s=t-e[i+1].value;return a<0?pt(e,t,n,i-1):s<0?i:pt(e,t,i+1,r)}var ji=(e,t,n)=>{let r=(e-t)/(n-t);return[1-r,r]};function Gi(e){return e.value!==void 0&&e.mapped!==void 0}function Yi(e){return e.length>0&&Gi(e[0])}function cn(e,t,n,r){return[e*t[0]+n*r[0],e*t[1]+n*r[1],e*t[2]+n*r[2]]}function un(e){return e||ji}function dn(e,t,n){return!Array.isArray(e)||e.length<1?Xi:Yi(e)?Hi(e,t,un(n),cn):Wi(e,t,un(n),cn)}function Hi(e,t,n,r){let i=e.sort((a,s)=>a.value<s.value?-1:1);return function(a){let s=t(a),o=pt(i,s,0,i.length-1);if(o==0&&s<i[0].value)return i[o].mapped;if(o==i.length-1)return i[o].mapped;let[f,l]=n(s,i[o].value,i[o+1].value);return r(f,i[o].mapped,l,i[o+1].mapped)}}function Wi(e,t,n,r){return function(i){let a=t(i),s=(e.length-1)*a;if(s<=0)return e[0];if(s>=e.length-1)return e[e.length-1];let o=Math.floor(s),[f,l]=n(s,o,o+1);return r(f,e[o],l,e[o+1])}}function Xi(e){return[0,0,0]}function vn(e,t){let[n,r]=e,[i,a]=t;return Math.abs(n-r)<Number.EPSILON&&(r=n+1),function(s){return i+(a-i)*((s-n)/(r-n))}}var gn=[[.001462,466e-6,.013866],[.002267,.00127,.01857],[.003299,.002249,.024239],[.004547,.003392,.030909],[.006006,.004692,.038558],[.007676,.006136,.046836],[.009561,.007713,.055143],[.011663,.009417,.06346],[.013995,.011225,.071862],[.016561,.013136,.080282],[.019373,.015133,.088767],[.022447,.017199,.097327],[.025793,.019331,.10593],[.029432,.021503,.114621],[.033385,.023702,.123397],[.037668,.025921,.132232],[.042253,.028139,.141141],[.046915,.030324,.150164],[.051644,.032474,.159254],[.056449,.034569,.168414],[.06134,.03659,.177642],[.066331,.038504,.186962],[.071429,.040294,.196354],[.076637,.041905,.205799],[.081962,.043328,.215289],[.087411,.044556,.224813],[.09299,.045583,.234358],[.098702,.046402,.243904],[.104551,.047008,.25343],[.110536,.047399,.262912],[.116656,.047574,.272321],[.122908,.047536,.281624],[.129285,.047293,.290788],[.135778,.046856,.299776],[.142378,.046242,.308553],[.149073,.045468,.317085],[.15585,.044559,.325338],[.162689,.043554,.333277],[.169575,.042489,.340874],[.176493,.041402,.348111],[.183429,.040329,.354971],[.190367,.039309,.361447],[.197297,.0384,.367535],[.204209,.037632,.373238],[.211095,.03703,.378563],[.217949,.036615,.383522],[.224763,.036405,.388129],[.231538,.036405,.3924],[.238273,.036621,.396353],[.244967,.037055,.400007],[.25162,.037705,.403378],[.258234,.038571,.406485],[.26481,.039647,.409345],[.271347,.040922,.411976],[.27785,.042353,.414392],[.284321,.043933,.416608],[.290763,.045644,.418637],[.297178,.04747,.420491],[.303568,.049396,.422182],[.309935,.051407,.423721],[.316282,.05349,.425116],[.32261,.055634,.426377],[.328921,.057827,.427511],[.335217,.06006,.428524],[.3415,.062325,.429425],[.347771,.064616,.430217],[.354032,.066925,.430906],[.360284,.069247,.431497],[.366529,.071579,.431994],[.372768,.073915,.4324],[.379001,.076253,.432719],[.385228,.078591,.432955],[.391453,.080927,.433109],[.397674,.083257,.433183],[.403894,.08558,.433179],[.410113,.087896,.433098],[.416331,.090203,.432943],[.422549,.092501,.432714],[.428768,.09479,.432412],[.434987,.097069,.432039],[.441207,.099338,.431594],[.447428,.101597,.43108],[.453651,.103848,.430498],[.459875,.106089,.429846],[.4661,.108322,.429125],[.472328,.110547,.428334],[.478558,.112764,.427475],[.484789,.114974,.426548],[.491022,.117179,.425552],[.497257,.119379,.424488],[.503493,.121575,.423356],[.50973,.123769,.422156],[.515967,.12596,.420887],[.522206,.12815,.419549],[.528444,.130341,.418142],[.534683,.132534,.416667],[.54092,.134729,.415123],[.547157,.136929,.413511],[.553392,.139134,.411829],[.559624,.141346,.410078],[.565854,.143567,.408258],[.572081,.145797,.406369],[.578304,.148039,.404411],[.584521,.150294,.402385],[.590734,.152563,.40029],[.59694,.154848,.398125],[.603139,.157151,.395891],[.60933,.159474,.393589],[.615513,.161817,.391219],[.621685,.164184,.388781],[.627847,.166575,.386276],[.633998,.168992,.383704],[.640135,.171438,.381065],[.64626,.173914,.378359],[.652369,.176421,.375586],[.658463,.178962,.372748],[.66454,.181539,.369846],[.670599,.184153,.366879],[.676638,.186807,.363849],[.682656,.189501,.360757],[.688653,.192239,.357603],[.694627,.195021,.354388],[.700576,.197851,.351113],[.7065,.200728,.347777],[.712396,.203656,.344383],[.718264,.206636,.340931],[.724103,.20967,.337424],[.729909,.212759,.333861],[.735683,.215906,.330245],[.741423,.219112,.326576],[.747127,.222378,.322856],[.752794,.225706,.319085],[.758422,.229097,.315266],[.76401,.232554,.311399],[.769556,.236077,.307485],[.775059,.239667,.303526],[.780517,.243327,.299523],[.785929,.247056,.295477],[.791293,.250856,.29139],[.796607,.254728,.287264],[.801871,.258674,.283099],[.807082,.262692,.278898],[.812239,.266786,.274661],[.817341,.270954,.27039],[.822386,.275197,.266085],[.827372,.279517,.26175],[.832299,.283913,.257383],[.837165,.288385,.252988],[.841969,.292933,.248564],[.846709,.297559,.244113],[.851384,.30226,.239636],[.855992,.307038,.235133],[.860533,.311892,.230606],[.865006,.316822,.226055],[.869409,.321827,.221482],[.873741,.326906,.216886],[.878001,.33206,.212268],[.882188,.337287,.207628],[.886302,.342586,.202968],[.890341,.347957,.198286],[.894305,.353399,.193584],[.898192,.358911,.18886],[.902003,.364492,.184116],[.905735,.37014,.17935],[.90939,.375856,.174563],[.912966,.381636,.169755],[.916462,.387481,.164924],[.919879,.393389,.16007],[.923215,.399359,.155193],[.92647,.405389,.150292],[.929644,.411479,.145367],[.932737,.417627,.140417],[.935747,.423831,.13544],[.938675,.430091,.130438],[.941521,.436405,.125409],[.944285,.442772,.120354],[.946965,.449191,.115272],[.949562,.45566,.110164],[.952075,.462178,.105031],[.954506,.468744,.099874],[.956852,.475356,.094695],[.959114,.482014,.089499],[.961293,.488716,.084289],[.963387,.495462,.079073],[.965397,.502249,.073859],[.967322,.509078,.068659],[.969163,.515946,.063488],[.970919,.522853,.058367],[.97259,.529798,.053324],[.974176,.53678,.048392],[.975677,.543798,.043618],[.977092,.55085,.03905],[.978422,.557937,.034931],[.979666,.565057,.031409],[.980824,.572209,.028508],[.981895,.579392,.02625],[.982881,.586606,.024661],[.983779,.593849,.02377],[.984591,.601122,.023606],[.985315,.608422,.024202],[.985952,.61575,.025592],[.986502,.623105,.027814],[.986964,.630485,.030908],[.987337,.63789,.034916],[.987622,.64532,.039886],[.987819,.652773,.045581],[.987926,.66025,.05175],[.987945,.667748,.058329],[.987874,.675267,.065257],[.987714,.682807,.072489],[.987464,.690366,.07999],[.987124,.697944,.087731],[.986694,.70554,.095694],[.986175,.713153,.103863],[.985566,.720782,.112229],[.984865,.728427,.120785],[.984075,.736087,.129527],[.983196,.743758,.138453],[.982228,.751442,.147565],[.981173,.759135,.156863],[.980032,.766837,.166353],[.978806,.774545,.176037],[.977497,.782258,.185923],[.976108,.789974,.196018],[.974638,.797692,.206332],[.973088,.805409,.216877],[.971468,.813122,.227658],[.969783,.820825,.238686],[.968041,.828515,.249972],[.966243,.836191,.261534],[.964394,.843848,.273391],[.962517,.851476,.285546],[.960626,.859069,.29801],[.95872,.866624,.31082],[.956834,.874129,.323974],[.954997,.881569,.337475],[.953215,.888942,.351369],[.951546,.896226,.365627],[.950018,.903409,.380271],[.948683,.910473,.395289],[.947594,.917399,.410665],[.946809,.924168,.426373],[.946392,.930761,.442367],[.946403,.937159,.458592],[.946903,.943348,.47497],[.947937,.949318,.491426],[.949545,.955063,.50786],[.95174,.960587,.524203],[.954529,.965896,.540361],[.957896,.971003,.556275],[.961812,.975924,.571925],[.966249,.980678,.587206],[.971162,.985282,.602154],[.976511,.989753,.61676],[.982257,.994109,.631017],[.988362,.998364,.644924]];var pn=class{constructor(t,n,r,i){for(let[a,s]of Object.entries(t))a=="color"||a=="size"||a=="position"||a=="outlineColor"||a=="outlineWidth"||(this[a]=s);this._network=i,this.ID=n,this.index=r}set color(t){let n=this.index;this._network.colors[n*3+0]=t[0],this._network.colors[n*3+1]=t[1],this._network.colors[n*3+2]=t[2]}get color(){let t=this.index;return[this._network.colors[t*3+0],this._network.colors[t*3+1],this._network.colors[t*3+2]]}set size(t){this._network.sizes[this.index]=t}get size(){return this._network.sizes[this.index]}set outlineColor(t){let n=this.index;this._network.outlineColors[n*3+0]=t[0],this._network.outlineColors[n*3+1]=t[1],this._network.outlineColors[n*3+2]=t[2]}get outlineColor(){let t=this.index;return[this._network.outlineColors[t*3+0],this._network.outlineColors[t*3+1],this._network.outlineColors[t*3+2]]}set outlineWidth(t){this._network.outlineWidths[this.index]=t}get outlineWidth(){return this._network.outlineWidths[this.index]}get network(){return this._network}set position(t){let n=this.index;this._network.positions[n*3+0]=t[0],this._network.positions[n*3+1]=t[1],this._network.positions[n*3+2]=t[2]}get position(){let t=this.index;return[this._network.positions[t*3+0],this._network.positions[t*3+1],this._network.positions[t*3+2]]}},mt=class{constructor(t,n,r){this.ID2index=new Object,this.index2Node=[];for(let[s,o]of Object.entries(t))if(!this.ID2index.hasOwnProperty(s)){let f=this.index2Node.length;this.ID2index[s]=f,o.index=f,o.ID=s,this.index2Node.push(o)}this.indexedEdges=new Int32Array(n.length*2);for(let s=0;s<n.length;s++){let o=n[s];this.indexedEdges[s*2]=this.ID2index[o.source],this.indexedEdges[s*2+1]=this.ID2index[o.target]}this.positions=new Float32Array(3*this.index2Node.length),this.colors=new Float32Array(3*this.index2Node.length),this.sizes=new Float32Array(this.index2Node.length),this.intensities=new Float32Array(this.index2Node.length),this.outlineColors=new Float32Array(3*this.index2Node.length),this.outlineWidths=new Float32Array(this.index2Node.length),this.nodes={};let i=vn([0,this.index2Node.length],[0,1]),a=dn(gn,i);for(let s=0;s<this.index2Node.length;s++){let o=this.index2Node[s];if(o.hasOwnProperty("position")?(this.positions[s*3]=o.position[0],this.positions[s*3+1]=o.position[1],this.positions[s*3+2]=o.position[2]):(this.positions[s*3+0]=(Math.random()-.5)*2*200,this.positions[s*3+1]=(Math.random()-.5)*2*200,this.positions[s*3+2]=(Math.random()-.5)*2*200),o.hasOwnProperty("color"))s==0&&console.log("NODE COLOR:",o.color),this.colors[s*3+0]=o.color[0],this.colors[s*3+1]=o.color[1],this.colors[s*3+2]=o.color[2];else{let l=a(s);this.colors[s*3+0]=l[0],this.colors[s*3+1]=l[1],this.colors[s*3+2]=l[2]}o.hasOwnProperty("size")?this.sizes[s]=o.size:this.sizes[s]=1,o.hasOwnProperty("outlineColor")?(this.outlineColors[s*3+0]=o.outlineColor[0],this.outlineColors[s*3+1]=o.outlineColor[1],this.outlineColors[s*3+2]=o.outlineColor[2]):(this.outlineColors[s*3+0]=255,this.outlineColors[s*3+1]=255,this.outlineColors[s*3+2]=255),o.hasOwnProperty("outlineWidth")?this.outlineWidths[s]=o.outlineWidth:this.outlineWidths[s]=0,this.intensities[s]=1;let f=new pn(o,o.ID,s,this);this.index2Node[s]=f,this.nodes[o.ID]=f}}};import.meta.env=Ee;var Df=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(e,1e3/60)}}(),Lf=window.cancelAnimationFrame||window.mozCancelAnimationFrame;function mn(e,t){let n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],r=null;for(let i=0;i<n.length;++i){try{r=e.getContext(n[i],t)}catch(a){}if(r)break}return r}async function ye(e,t){let n=document.getElementById(t);if(!n)return null;let r="",i=n.firstChild;for(;i;)i.nodeType==3&&(r+=i.textContent),i=i.nextSibling;n.src&&(r=await fetch(n.src).then(s=>s.text()));let a;if(n.type=="text/glsl-fragment")a=e.createShader(e.FRAGMENT_SHADER);else if(n.type=="text/glsl-vertex")a=e.createShader(e.VERTEX_SHADER);else return null;return e.shaderSource(a,r),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(console.log("ERROR with script: ",t),console.log(e.getShaderInfoLog(a)),null)}function Pe(e,t,n,r,i){let a=i.createProgram();if(i.attachShader(a,e),i.attachShader(a,t),i.linkProgram(a),!i.getProgramParameter(a,i.LINK_STATUS)){alert("Shader Compilation Error."+i.getProgramInfoLog(a));return}if(this.ID=a,this.uniforms=new Object,this.attributes=new Object,n)for(let s=0;s<n.length;s++)this.uniforms[n[s]]=i.getUniformLocation(this.ID,n[s]);if(this.attributes.enable=function(s){i.enableVertexAttribArray(this[s])},this.attributes.disable=function(s){i.disableVertexAttribArray(this[s])},r)for(let s=0;s<r.length;s++)this.attributes[r[s]]=i.getAttribLocation(this.ID,r[s]);this.use=function(s){s.useProgram(this.ID)}}function An(e,t=!0,n=!0){let r=[-1,1,0,-1,-1,0,1,1,0,1,-1,0],i=[0,0,1,0,0,1,0,0,1,0,0,1],a=[0,1,0,1,0,0,1,1,0,0,0,0],s={};return n&&(s.texCoordObject=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s.texCoordObject),e.bufferData(e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW)),t&&(s.normalObject=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s.normalObject),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW)),s.vertexObject=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s.vertexObject),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),s.numIndices=4,s}function At(e){return e*Math.PI/180}var Qe={};Ot(Qe,{loadXNET:()=>yn,loadXNETFile:()=>oa});"use strict";var Vi=e=>{let t=e.split(/\s/);return t.length<2?null:[+t[0],+t[1]]},Zi=e=>{let t=e.split(/\s/);return t.length<3?null:[+t[0],+t[1],+t[2]]},Ki=e=>isNaN(e)?0:+e,Ji=/#([ve]) \"(.+)\" ([sn]|v2|v3)/,ea={s:String,n:Ki,v2:Vi,v3:Zi},ta=e=>{for(;e.lineIndex+1<e.lines.length&&e.lines[e.lineIndex].length==0;)e.lineIndex++;let n=e.lines[e.lineIndex].split(/\s/),r=0;if(n.length==0||n[0].toLowerCase()!="#vertices"||isNaN(n[1])||!Number.isInteger(+n[1]))throw`Malformed xnet data (Reading Vertices Header)[line: ${e.lineIndex}]
	> ${e.lines[e.lineIndex]}`;return r=+n[1],e.lineIndex++,r},na=e=>{let t=[];for(;e.lineIndex<e.lines.length;){let r=e.lines[e.lineIndex],i=r.length;if(i==0){e.lineIndex++;continue}if(r[0]=="#")break;var n=r;r[0]=='"'&&r[i-1]=='"'&&(n=r.slice(1,-1)),t.push(n),e.lineIndex++}return t},ra=e=>{for(;e.lineIndex+1<e.lines.length&&e.lines[e.lineIndex].length==0;)e.lineIndex++;let n=e.lines[e.lineIndex].split(/\s/),r=!1,i=!1;if(n.length==0||n[0].toLowerCase()!="#edges")throw`Malformed xnet data (Reading Edges Header)[line: ${e.lineIndex}]
	> ${e.lines[e.lineIndex]}`;return n.forEach(a=>{a.toLowerCase()=="weighted"&&(r=!0),a.toLowerCase()=="nonweighted"&&(r=!1),a.toLowerCase()=="directed"&&(i=!0),a.toLowerCase()=="undirected"&&(i=!1)}),e.lineIndex++,{weighted:r,directed:i}},ia=e=>{let t=[],n=[];for(;e.lineIndex<e.lines.length;){let r=e.lines[e.lineIndex];if(r.length==0){e.lineIndex++;continue}if(r[0]=="#")break;let a=r.split(/\s/),s=1;if(a.length<2)throw`Malformed xnet data (Reading Edges)[line: ${e.lineIndex}]
	> ${e.lines[e.lineIndex]}`;a.length>2&&(s=+a[2]),t.push([+a[0],+a[1]]),n.push(s),e.lineIndex++}return{edges:t,weights:n}},aa=e=>{for(;e.lineIndex+1<e.lines.length&&e.lines[e.lineIndex].length==0;)e.lineIndex++;let t=Ji.exec(e.lines[e.lineIndex]);if(t.length!=4)throw`Malformed xnet data [line: ${e.lineIndex}]
	> ${e.lines[e.lineIndex]}`;let n=t[1],r=t[2],i=t[3];return e.lineIndex++,{type:n,key:r,format:i}},sa=(e,t)=>{let n=[],r=ea[t.format];for(;e.lineIndex<e.lines.length;){let i=e.lines[e.lineIndex],a=i.length;if(a==0){e.lineIndex++;continue}if(i[0]=="#")break;let s=i;s[0]=='"'&&s[a-1]=='"'&&(s=s.slice(1,-1)),n.push(r(s)),e.lineIndex++}return n},yn=e=>{let t={lineIndex:0,lines:e.split(`
`)},n=ta(t),r=na(t),i={nodesCount:n,verticesProperties:{},edgesProperties:{}};if(r.length>0){if(r.length<n)throw`Malformed xnet data [line: ${t.lineIndex}]
	> ${t.lines[t.lineIndex]}`;i.labels=r}let a=ra(t);i.directed=a.directed,i.weighted=a.weighted;let s=ia(t);i.edges=s.edges,i.weighted&&(i.weights=s.weights);do{for(;t.lineIndex<t.lines.length&&t.lines[t.lineIndex].length==0;)t.lineIndex++;if(!(t.lineIndex<t.lines.length))break;let o=aa(t),f=sa(t,o);o.type=="e"?i.edgesProperties[o.key]=f:o.type=="v"&&(i.verticesProperties[o.key]=f)}while(t.lineIndex<t.lines.length);return i};async function oa(e){let t=await fetch(e).then(n=>n.text());return yn(t)}var yt="http://www.w3.org/1999/xhtml",wn={svg:"http://www.w3.org/2000/svg",xhtml:yt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Be(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wn.hasOwnProperty(t)?{space:wn[t],local:e}:e}function la(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===yt&&t.documentElement.namespaceURI===yt?t.createElement(e):t.createElementNS(n,e)}}function fa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xn(e){var t=Be(e);return(t.local?fa:la)(t)}function ha(){}function qe(e){return e==null?ha:function(){return this.querySelector(e)}}function ca(e){typeof e!="function"&&(e=qe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],s=a.length,o=r[i]=new Array(s),f,l,h=0;h<s;++h)(f=a[h])&&(l=e.call(f,f.__data__,h,a))&&("__data__"in f&&(l.__data__=f.__data__),o[h]=l);return new Z(r,this._parents)}function ua(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function da(){return[]}function wt(e){return e==null?da:function(){return this.querySelectorAll(e)}}function va(e){return function(){return ua(e.apply(this,arguments))}}function ga(e){typeof e=="function"?e=va(e):e=wt(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var s=t[a],o=s.length,f,l=0;l<o;++l)(f=s[l])&&(r.push(e.call(f,f.__data__,l,s)),i.push(f));return new Z(r,i)}function xt(e){return function(){return this.matches(e)}}function _n(e){return function(t){return t.matches(e)}}var pa=Array.prototype.find;function ma(e){return function(){return pa.call(this.children,e)}}function Aa(){return this.firstElementChild}function ya(e){return this.select(e==null?Aa:ma(typeof e=="function"?e:_n(e)))}var wa=Array.prototype.filter;function xa(){return Array.from(this.children)}function _a(e){return function(){return wa.call(this.children,e)}}function ba(e){return this.selectAll(e==null?xa:_a(typeof e=="function"?e:_n(e)))}function Ma(e){typeof e!="function"&&(e=xt(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],s=a.length,o=r[i]=[],f,l=0;l<s;++l)(f=a[l])&&e.call(f,f.__data__,l,a)&&o.push(f);return new Z(r,this._parents)}function bn(e){return new Array(e.length)}function Ia(){return new Z(this._enter||this._groups.map(bn),this._parents)}function Oe(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Oe.prototype={constructor:Oe,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ea(e){return function(){return e}}function Ba(e,t,n,r,i,a){for(var s=0,o,f=t.length,l=a.length;s<l;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new Oe(e,a[s]);for(;s<f;++s)(o=t[s])&&(i[s]=o)}function Ca(e,t,n,r,i,a,s){var o,f,l=new Map,h=t.length,c=a.length,u=new Array(h),d;for(o=0;o<h;++o)(f=t[o])&&(u[o]=d=s.call(f,f.__data__,o,t)+"",l.has(d)?i[o]=f:l.set(d,f));for(o=0;o<c;++o)d=s.call(e,a[o],o,a)+"",(f=l.get(d))?(r[o]=f,f.__data__=a[o],l.delete(d)):n[o]=new Oe(e,a[o]);for(o=0;o<h;++o)(f=t[o])&&l.get(u[o])===f&&(i[o]=f)}function ka(e){return e.__data__}function Fa(e,t){if(!arguments.length)return Array.from(this,ka);var n=t?Ca:Ba,r=this._parents,i=this._groups;typeof e!="function"&&(e=Ea(e));for(var a=i.length,s=new Array(a),o=new Array(a),f=new Array(a),l=0;l<a;++l){var h=r[l],c=i[l],u=c.length,d=Ra(e.call(h,h&&h.__data__,l,r)),v=d.length,m=o[l]=new Array(v),p=s[l]=new Array(v),w=f[l]=new Array(u);n(h,c,m,p,w,d,t);for(var M=0,I=0,x,_;M<v;++M)if(x=m[M]){for(M>=I&&(I=M+1);!(_=p[I])&&++I<v;);x._next=_||null}}return s=new Z(s,r),s._enter=o,s._exit=f,s}function Ra(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Sa(){return new Z(this._exit||this._groups.map(bn),this._parents)}function Na(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function $a(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,s=Math.min(i,a),o=new Array(i),f=0;f<s;++f)for(var l=n[f],h=r[f],c=l.length,u=o[f]=new Array(c),d,v=0;v<c;++v)(d=l[v]||h[v])&&(u[v]=d);for(;f<i;++f)o[f]=n[f];return new Z(o,this._parents)}function za(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Da(e){e||(e=Ta);function t(c,u){return c&&u?e(c.__data__,u.__data__):!c-!u}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s=n[a],o=s.length,f=i[a]=new Array(o),l,h=0;h<o;++h)(l=s[h])&&(f[h]=l);f.sort(t)}return new Z(i,this._parents).order()}function Ta(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function La(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Pa(){return Array.from(this)}function Qa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function qa(){let e=0;for(let t of this)++e;return e}function Oa(){return!this.node()}function Ua(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,s=i.length,o;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this}function ja(e){return function(){this.removeAttribute(e)}}function Ga(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ya(e,t){return function(){this.setAttribute(e,t)}}function Ha(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Wa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Xa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Va(e,t){var n=Be(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Ga:ja:typeof t=="function"?n.local?Xa:Wa:n.local?Ha:Ya)(n,t))}function Mn(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Za(e){return function(){this.style.removeProperty(e)}}function Ka(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ja(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function es(e,t,n){return arguments.length>1?this.each((t==null?Za:typeof t=="function"?Ja:Ka)(e,t,n??"")):ve(this.node(),e)}function ve(e,t){return e.style.getPropertyValue(t)||Mn(e).getComputedStyle(e,null).getPropertyValue(t)}function ts(e){return function(){delete this[e]}}function ns(e,t){return function(){this[e]=t}}function rs(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function is(e,t){return arguments.length>1?this.each((t==null?ts:typeof t=="function"?rs:ns)(e,t)):this.node()[e]}function In(e){return e.trim().split(/^|\s+/)}function _t(e){return e.classList||new En(e)}function En(e){this._node=e,this._names=In(e.getAttribute("class")||"")}En.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Bn(e,t){for(var n=_t(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Cn(e,t){for(var n=_t(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function as(e){return function(){Bn(this,e)}}function ss(e){return function(){Cn(this,e)}}function os(e,t){return function(){(t.apply(this,arguments)?Bn:Cn)(this,e)}}function ls(e,t){var n=In(e+"");if(arguments.length<2){for(var r=_t(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?os:t?as:ss)(n,t))}function fs(){this.textContent=""}function hs(e){return function(){this.textContent=e}}function cs(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function us(e){return arguments.length?this.each(e==null?fs:(typeof e=="function"?cs:hs)(e)):this.node().textContent}function ds(){this.innerHTML=""}function vs(e){return function(){this.innerHTML=e}}function gs(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ps(e){return arguments.length?this.each(e==null?ds:(typeof e=="function"?gs:vs)(e)):this.node().innerHTML}function ms(){this.nextSibling&&this.parentNode.appendChild(this)}function As(){return this.each(ms)}function ys(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ws(){return this.each(ys)}function xs(e){var t=typeof e=="function"?e:xn(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function _s(){return null}function bs(e,t){var n=typeof e=="function"?e:xn(e),r=t==null?_s:typeof t=="function"?t:qe(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ms(){var e=this.parentNode;e&&e.removeChild(this)}function Is(){return this.each(Ms)}function Es(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Bs(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Cs(e){return this.select(e?Bs:Es)}function ks(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Rs(e){return function(t){e.call(this,t,this.__data__)}}function Fs(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ss(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function Ns(e,t,n){return function(){var r=this.__on,i,a=Rs(t);if(r){for(var s=0,o=r.length;s<o;++s)if((i=r[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function $s(e,t,n){var r=Fs(e+""),i,a=r.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var f=0,l=o.length,h;f<l;++f)for(i=0,h=o[f];i<a;++i)if((s=r[i]).type===h.type&&s.name===h.name)return h.value}return}for(o=t?Ns:Ss,i=0;i<a;++i)this.each(o(r[i],t,n));return this}function kn(e,t,n){var r=Mn(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function zs(e,t){return function(){return kn(this,e,t)}}function Ts(e,t){return function(){return kn(this,e,t.apply(this,arguments))}}function Ds(e,t){return this.each((typeof t=="function"?Ts:zs)(e,t))}function*Ls(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,s;i<a;++i)(s=r[i])&&(yield s)}var Rn=[null];function Z(e,t){this._groups=e,this._parents=t}function we(){return new Z([[document.documentElement]],Rn)}function Ps(){return this}Z.prototype=we.prototype={constructor:Z,select:ca,selectAll:ga,selectChild:ya,selectChildren:ba,filter:Ma,data:Fa,enter:Ia,exit:Sa,join:Na,merge:$a,selection:Ps,order:za,sort:Da,call:La,nodes:Pa,node:Qa,size:qa,empty:Oa,each:Ua,attr:Va,style:es,property:is,classed:ls,text:us,html:ps,raise:As,lower:ws,append:xs,insert:bs,remove:Is,clone:Cs,datum:ks,on:$s,dispatch:Ds,[Symbol.iterator]:Ls};function H(e){return typeof e=="string"?new Z([[document.querySelector(e)]],[document.documentElement]):new Z([[e]],Rn)}var Qs={value:()=>{}};function ge(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ue(n)}function Ue(e){this._=e}function qs(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ue.prototype=ge.prototype={constructor:Ue,on:function(e,t){var n=this._,r=qs(e+"",n),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(e=r[a]).type)&&(i=Os(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<s;)if(i=(e=r[a]).type)n[i]=Fn(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Fn(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ue(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Os(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Fn(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Qs,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var xe=0,Ce=0,ke=0,Sn=1e3,je,Re,Ge=0,pe=0,Ye=0,Fe=typeof performance=="object"&&performance.now?performance:Date,Nn=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function He(){return pe||(Nn(Us),pe=Fe.now()+Ye)}function Us(){pe=0}function Se(){this._call=this._time=this._next=null}Se.prototype=We.prototype={constructor:Se,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?He():+n)+(t==null?0:+t),!this._next&&Re!==this&&(Re?Re._next=this:je=this,Re=this),this._call=e,this._time=n,bt()},stop:function(){this._call&&(this._call=null,this._time=Infinity,bt())}};function We(e,t,n){var r=new Se;return r.restart(e,t,n),r}function js(){He(),++xe;for(var e=je,t;e;)(t=pe-e._time)>=0&&e._call.call(void 0,t),e=e._next;--xe}function $n(){pe=(Ge=Fe.now())+Ye,xe=Ce=0;try{js()}finally{xe=0,Gs(),pe=0}}function Ys(){var e=Fe.now(),t=e-Ge;t>Sn&&(Ye-=t,Ge=e)}function Gs(){for(var e,t=je,n,r=Infinity;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:je=n);Re=e,bt(r)}function bt(e){if(!xe){Ce&&(Ce=clearTimeout(Ce));var t=e-pe;t>24?(e<Infinity&&(Ce=setTimeout($n,e-Fe.now()-Ye)),ke&&(ke=clearInterval(ke))):(ke||(Ge=Fe.now(),ke=setInterval(Ys,Sn)),xe=1,Nn($n))}}function oe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Mt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,It=new RegExp(Mt.source,"g");function Hs(e){return function(){return e}}function Ws(e){return function(t){return e(t)+""}}function zn(e,t){var n=Mt.lastIndex=It.lastIndex=0,r,i,a,s=-1,o=[],f=[];for(e=e+"",t=t+"";(r=Mt.exec(e))&&(i=It.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),o[s]?o[s]+=a:o[++s]=a),(r=r[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,f.push({i:s,x:oe(r,i)})),n=It.lastIndex;return n<t.length&&(a=t.slice(n),o[s]?o[s]+=a:o[++s]=a),o.length<2?f[0]?Ws(f[0].x):Hs(t):(t=f.length,function(l){for(var h=0,c;h<t;++h)o[(c=f[h]).i]=c.x(l);return o.join("")})}function Et(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Tn(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ne(){}var $e=.7,Xe=1/$e,_e="\\s*([+-]?\\d+)\\s*",ze="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",re="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xs=/^#([0-9a-f]{3,8})$/,Vs=new RegExp("^rgb\\("+[_e,_e,_e]+"\\)$"),Zs=new RegExp("^rgb\\("+[re,re,re]+"\\)$"),Ks=new RegExp("^rgba\\("+[_e,_e,_e,ze]+"\\)$"),Js=new RegExp("^rgba\\("+[re,re,re,ze]+"\\)$"),eo=new RegExp("^hsl\\("+[ze,re,re]+"\\)$"),to=new RegExp("^hsla\\("+[ze,re,re,ze]+"\\)$"),Dn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Et(Ne,be,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Ln,formatHex:Ln,formatHsl:no,formatRgb:Pn,toString:Pn});function Ln(){return this.rgb().formatHex()}function no(){return Qn(this).formatHsl()}function Pn(){return this.rgb().formatRgb()}function be(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Xs.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?qn(t):n===3?new K(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ve(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ve(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Vs.exec(e))?new K(t[1],t[2],t[3],1):(t=Zs.exec(e))?new K(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ks.exec(e))?Ve(t[1],t[2],t[3],t[4]):(t=Js.exec(e))?Ve(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eo.exec(e))?On(t[1],t[2]/100,t[3]/100,1):(t=to.exec(e))?On(t[1],t[2]/100,t[3]/100,t[4]):Dn.hasOwnProperty(e)?qn(Dn[e]):e==="transparent"?new K(NaN,NaN,NaN,0):null}function qn(e){return new K(e>>16&255,e>>8&255,e&255,1)}function Ve(e,t,n,r){return r<=0&&(e=t=n=NaN),new K(e,t,n,r)}function ro(e){return e instanceof Ne||(e=be(e)),e?(e=e.rgb(),new K(e.r,e.g,e.b,e.opacity)):new K}function Te(e,t,n,r){return arguments.length===1?ro(e):new K(e,t,n,r??1)}function K(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Et(K,Te,Tn(Ne,{brighter:function(e){return e=e==null?Xe:Math.pow(Xe,e),new K(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?$e:Math.pow($e,e),new K(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Un,formatHex:Un,formatRgb:jn,toString:jn}));function Un(){return"#"+Bt(this.r)+Bt(this.g)+Bt(this.b)}function jn(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Bt(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function On(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ie(e,t,n,r)}function Qn(e){if(e instanceof ie)return new ie(e.h,e.s,e.l,e.opacity);if(e instanceof Ne||(e=be(e)),!e)return new ie;if(e instanceof ie)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),s=NaN,o=a-i,f=(a+i)/2;return o?(t===a?s=(n-r)/o+(n<r)*6:n===a?s=(r-t)/o+2:s=(t-n)/o+4,o/=f<.5?a+i:2-a-i,s*=60):o=f>0&&f<1?0:s,new ie(s,o,f,e.opacity)}function io(e,t,n,r){return arguments.length===1?Qn(e):new ie(e,t,n,r??1)}function ie(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Et(ie,io,Tn(Ne,{brighter:function(e){return e=e==null?Xe:Math.pow(Xe,e),new ie(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?$e:Math.pow($e,e),new ie(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new K(Ct(e>=240?e-240:e+120,i,r),Ct(e,i,r),Ct(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Ct(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function ao(e,t,n,r,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*n+(1+3*e+3*a-3*s)*r+s*i)/6}function so(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],s=r>0?e[r-1]:2*i-a,o=r<t-1?e[r+2]:2*a-i;return ao((n-r/t)*t,s,i,a,o)}}var Gn=e=>()=>e;function oo(e,t){return function(n){return e+n*t}}function lo(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function fo(e){return(e=+e)==1?Yn:function(t,n){return n-t?lo(t,n,e):Gn(isNaN(t)?n:t)}}function Yn(e,t){var n=t-e;return n?oo(e,n):Gn(isNaN(e)?t:e)}var kt=function e(t){var n=fo(t);function r(i,a){var s=n((i=Te(i)).r,(a=Te(a)).r),o=n(i.g,a.g),f=n(i.b,a.b),l=Yn(i.opacity,a.opacity);return function(h){return i.r=s(h),i.g=o(h),i.b=f(h),i.opacity=l(h),i+""}}return r.gamma=e,r}(1);function ho(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),s,o;for(s=0;s<n;++s)o=Te(t[s]),r[s]=o.r||0,i[s]=o.g||0,a[s]=o.b||0;return r=e(r),i=e(i),a=e(a),o.opacity=1,function(f){return o.r=r(f),o.g=i(f),o.b=a(f),o+""}}}var Wf=ho(so);function co(e){let t;for(;t=e.sourceEvent;)e=t;return e}function te(e,t){if(e=co(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var Hn={passive:!1},Me={capture:!0,passive:!1};function Ze(e){e.stopImmediatePropagation()}function me(e){e.preventDefault(),e.stopImmediatePropagation()}function Ke(e){var t=e.document.documentElement,n=H(e).on("dragstart.drag",me,Me);"onselectstart"in t?n.on("selectstart.drag",me,Me):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Je(e,t){var n=e.document.documentElement,r=H(e).on("dragstart.drag",null);t&&(r.on("click.drag",me,Me),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Wn(e,t,n){var r=new Se;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Xn=180/Math.PI,Rt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Vn(e,t,n,r,i,a){var s,o,f;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(f=e*n+t*r)&&(n-=e*f,r-=t*f),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,f/=o),e*r<t*n&&(e=-e,t=-t,f=-f,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Xn,skewX:Math.atan(f)*Xn,scaleX:s,scaleY:o}}var et;function uo(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Rt:Vn(t.a,t.b,t.c,t.d,t.e,t.f)}function vo(e){return e==null||(et||(et=document.createElementNS("http://www.w3.org/2000/svg","g")),et.setAttribute("transform",e),!(e=et.transform.baseVal.consolidate()))?Rt:(e=e.matrix,Vn(e.a,e.b,e.c,e.d,e.e,e.f))}function Zn(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,h,c,u,d,v){if(l!==c||h!==u){var m=d.push("translate(",null,t,null,n);v.push({i:m-4,x:oe(l,c)},{i:m-2,x:oe(h,u)})}else(c||u)&&d.push("translate("+c+t+u+n)}function s(l,h,c,u){l!==h?(l-h>180?h+=360:h-l>180&&(l+=360),u.push({i:c.push(i(c)+"rotate(",null,r)-2,x:oe(l,h)})):h&&c.push(i(c)+"rotate("+h+r)}function o(l,h,c,u){l!==h?u.push({i:c.push(i(c)+"skewX(",null,r)-2,x:oe(l,h)}):h&&c.push(i(c)+"skewX("+h+r)}function f(l,h,c,u,d,v){if(l!==c||h!==u){var m=d.push(i(d)+"scale(",null,",",null,")");v.push({i:m-4,x:oe(l,c)},{i:m-2,x:oe(h,u)})}else(c!==1||u!==1)&&d.push(i(d)+"scale("+c+","+u+")")}return function(l,h){var c=[],u=[];return l=e(l),h=e(h),a(l.translateX,l.translateY,h.translateX,h.translateY,c,u),s(l.rotate,h.rotate,c,u),o(l.skewX,h.skewX,c,u),f(l.scaleX,l.scaleY,h.scaleX,h.scaleY,c,u),l=h=null,function(d){for(var v=-1,m=u.length,p;++v<m;)c[(p=u[v]).i]=p.x(d);return c.join("")}}}var go=Zn(uo,"px, ","px)","deg)"),po=Zn(vo,", ",")",")"),mo=1e-12;function Kn(e){return((e=Math.exp(e))+1/e)/2}function Ao(e){return((e=Math.exp(e))-1/e)/2}function yo(e){return((e=Math.exp(2*e))-1)/(e+1)}var wo=function e(t,n,r){function i(a,s){var o=a[0],f=a[1],l=a[2],h=s[0],c=s[1],u=s[2],d=h-o,v=c-f,m=d*d+v*v,p,w;if(m<mo)w=Math.log(u/l)/t,p=function(F){return[o+F*d,f+F*v,l*Math.exp(t*F*w)]};else{var M=Math.sqrt(m),I=(u*u-l*l+r*m)/(2*l*n*M),x=(u*u-l*l-r*m)/(2*u*n*M),_=Math.log(Math.sqrt(I*I+1)-I),E=Math.log(Math.sqrt(x*x+1)-x);w=(E-_)/t,p=function(F){var R=F*w,S=Kn(_),N=l/(n*M)*(S*yo(t*R+_)-Ao(_));return[o+N*d,f+N*v,l*S/Kn(t*R+_)]}}return p.duration=w*1e3*t/Math.SQRT2,p}return i.rho=function(a){var s=Math.max(.001,+a),o=s*s,f=o*o;return e(s,o,f)},i}(Math.SQRT2,2,4),xo=ge("start","end","cancel","interrupt"),_o=[],Jn=0,er=1,Ft=2,tt=3,tr=4,St=5,nt=6;function rt(e,t,n,r,i,a){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;bo(e,n,{name:t,index:r,group:i,on:xo,tween:_o,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Jn})}function Nt(e,t){var n=ne(e,t);if(n.state>Jn)throw new Error("too late; already scheduled");return n}function ae(e,t){var n=ne(e,t);if(n.state>tt)throw new Error("too late; already running");return n}function ne(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function bo(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=We(a,0,n.time);function a(l){n.state=er,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var h,c,u,d;if(n.state!==er)return f();for(h in r)if(d=r[h],d.name===n.name){if(d.state===tt)return Wn(s);d.state===tr?(d.state=nt,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[h]):+h<t&&(d.state=nt,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[h])}if(Wn(function(){n.state===tt&&(n.state=tr,n.timer.restart(o,n.delay,n.time),o(l))}),n.state=Ft,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Ft){for(n.state=tt,i=new Array(u=n.tween.length),h=0,c=-1;h<u;++h)(d=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++c]=d);i.length=c+1}}function o(l){for(var h=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(f),n.state=St,1),c=-1,u=i.length;++c<u;)i[c].call(e,h);n.state===St&&(n.on.call("end",e,e.__data__,n.index,n.group),f())}function f(){n.state=nt,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function it(e,t){var n=e.__transition,r,i,a=!0,s;if(!!n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){a=!1;continue}i=r.state>Ft&&r.state<St,r.state=nt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}a&&delete e.__transition}}function Mo(e){return this.each(function(){it(this,e)})}function Io(e,t){var n,r;return function(){var i=ae(this,e),a=i.tween;if(a!==n){r=n=a;for(var s=0,o=r.length;s<o;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Eo(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=ae(this,e),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:t,value:n},f=0,l=i.length;f<l;++f)if(i[f].name===t){i[f]=o;break}f===l&&i.push(o)}a.tween=i}}function Bo(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ne(this.node(),n).tween,i=0,a=r.length,s;i<a;++i)if((s=r[i]).name===e)return s.value;return null}return this.each((t==null?Io:Eo)(n,e,t))}function $t(e,t,n){var r=e._id;return e.each(function(){var i=ae(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return ne(i,r).value[t]}}function nr(e,t){var n;return(typeof t=="number"?oe:t instanceof be?kt:(n=be(t))?(t=n,kt):zn)(e,t)}function Co(e){return function(){this.removeAttribute(e)}}function ko(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ro(e,t,n){var r,i=n+"",a;return function(){var s=this.getAttribute(e);return s===i?null:s===r?a:a=t(r=s,n)}}function Fo(e,t,n){var r,i=n+"",a;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===r?a:a=t(r=s,n)}}function So(e,t,n){var r,i,a;return function(){var s,o=n(this),f;return o==null?void this.removeAttribute(e):(s=this.getAttribute(e),f=o+"",s===f?null:s===r&&f===i?a:(i=f,a=t(r=s,o)))}}function No(e,t,n){var r,i,a;return function(){var s,o=n(this),f;return o==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),f=o+"",s===f?null:s===r&&f===i?a:(i=f,a=t(r=s,o)))}}function $o(e,t){var n=Be(e),r=n==="transform"?po:nr;return this.attrTween(e,typeof t=="function"?(n.local?No:So)(n,r,$t(this,"attr."+e,t)):t==null?(n.local?ko:Co)(n):(n.local?Fo:Ro)(n,r,t))}function zo(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function To(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Do(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&To(e,a)),n}return i._value=t,i}function Lo(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&zo(e,a)),n}return i._value=t,i}function Po(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Be(e);return this.tween(n,(r.local?Do:Lo)(r,t))}function Qo(e,t){return function(){Nt(this,e).delay=+t.apply(this,arguments)}}function qo(e,t){return t=+t,function(){Nt(this,e).delay=t}}function Oo(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Qo:qo)(t,e)):ne(this.node(),t).delay}function Uo(e,t){return function(){ae(this,e).duration=+t.apply(this,arguments)}}function jo(e,t){return t=+t,function(){ae(this,e).duration=t}}function Go(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Uo:jo)(t,e)):ne(this.node(),t).duration}function Yo(e,t){if(typeof t!="function")throw new Error;return function(){ae(this,e).ease=t}}function Ho(e){var t=this._id;return arguments.length?this.each(Yo(t,e)):ne(this.node(),t).ease}function Wo(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ae(this,e).ease=n}}function Xo(e){if(typeof e!="function")throw new Error;return this.each(Wo(this._id,e))}function Vo(e){typeof e!="function"&&(e=xt(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],s=a.length,o=r[i]=[],f,l=0;l<s;++l)(f=a[l])&&e.call(f,f.__data__,l,a)&&o.push(f);return new le(r,this._parents,this._name,this._id)}function Zo(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var f=t[o],l=n[o],h=f.length,c=s[o]=new Array(h),u,d=0;d<h;++d)(u=f[d]||l[d])&&(c[d]=u);for(;o<r;++o)s[o]=t[o];return new le(s,this._parents,this._name,this._id)}function Ko(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Jo(e,t,n){var r,i,a=Ko(t)?Nt:ae;return function(){var s=a(this,e),o=s.on;o!==r&&(i=(r=o).copy()).on(t,n),s.on=i}}function e1(e,t){var n=this._id;return arguments.length<2?ne(this.node(),n).on.on(e):this.each(Jo(n,e,t))}function t1(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function n1(){return this.on("end.remove",t1(this._id))}function r1(e){var t=this._name,n=this._id;typeof e!="function"&&(e=qe(e));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o=r[s],f=o.length,l=a[s]=new Array(f),h,c,u=0;u<f;++u)(h=o[u])&&(c=e.call(h,h.__data__,u,o))&&("__data__"in h&&(c.__data__=h.__data__),l[u]=c,rt(l[u],t,n,u,l,ne(h,n)));return new le(a,this._parents,t,n)}function i1(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wt(e));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var f=r[o],l=f.length,h,c=0;c<l;++c)if(h=f[c]){for(var u=e.call(h,h.__data__,c,f),d,v=ne(h,n),m=0,p=u.length;m<p;++m)(d=u[m])&&rt(d,t,n,m,u,v);a.push(u),s.push(h)}return new le(a,s,t,n)}var a1=we.prototype.constructor;function s1(){return new a1(this._groups,this._parents)}function o1(e,t){var n,r,i;return function(){var a=ve(this,e),s=(this.style.removeProperty(e),ve(this,e));return a===s?null:a===n&&s===r?i:i=t(n=a,r=s)}}function rr(e){return function(){this.style.removeProperty(e)}}function l1(e,t,n){var r,i=n+"",a;return function(){var s=ve(this,e);return s===i?null:s===r?a:a=t(r=s,n)}}function f1(e,t,n){var r,i,a;return function(){var s=ve(this,e),o=n(this),f=o+"";return o==null&&(f=o=(this.style.removeProperty(e),ve(this,e))),s===f?null:s===r&&f===i?a:(i=f,a=t(r=s,o))}}function h1(e,t){var n,r,i,a="style."+t,s="end."+a,o;return function(){var f=ae(this,e),l=f.on,h=f.value[a]==null?o||(o=rr(t)):void 0;(l!==n||i!==h)&&(r=(n=l).copy()).on(s,i=h),f.on=r}}function c1(e,t,n){var r=(e+="")==="transform"?go:nr;return t==null?this.styleTween(e,o1(e,r)).on("end.style."+e,rr(e)):typeof t=="function"?this.styleTween(e,f1(e,r,$t(this,"style."+e,t))).each(h1(this._id,e)):this.styleTween(e,l1(e,r,t),n).on("end.style."+e,null)}function u1(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function d1(e,t,n){var r,i;function a(){var s=t.apply(this,arguments);return s!==i&&(r=(i=s)&&u1(e,s,n)),r}return a._value=t,a}function v1(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,d1(e,t,n??""))}function g1(e){return function(){this.textContent=e}}function p1(e){return function(){var t=e(this);this.textContent=t??""}}function m1(e){return this.tween("text",typeof e=="function"?p1($t(this,"text",e)):g1(e==null?"":e+""))}function A1(e){return function(t){this.textContent=e.call(this,t)}}function y1(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&A1(i)),t}return r._value=e,r}function w1(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,y1(e))}function x1(){for(var e=this._name,t=this._id,n=ir(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,f,l=0;l<o;++l)if(f=s[l]){var h=ne(f,t);rt(f,e,n,l,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new le(r,this._parents,e,n)}function _1(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,s){var o={value:s},f={value:function(){--i==0&&a()}};n.each(function(){var l=ae(this,r),h=l.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(f)),l.on=t}),i===0&&a()})}var b1=0;function le(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ir(){return++b1}var fe=we.prototype;le.prototype={constructor:le,select:r1,selectAll:i1,selectChild:fe.selectChild,selectChildren:fe.selectChildren,filter:Vo,merge:Zo,selection:s1,transition:x1,call:fe.call,nodes:fe.nodes,node:fe.node,size:fe.size,empty:fe.empty,each:fe.each,on:e1,attr:$o,attrTween:Po,style:c1,styleTween:v1,text:m1,textTween:w1,remove:n1,tween:Bo,delay:Oo,duration:Go,ease:Ho,easeVarying:Xo,end:_1,[Symbol.iterator]:fe[Symbol.iterator]};function M1(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var I1={time:null,delay:0,duration:250,ease:M1};function E1(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function B1(e){var t,n;e instanceof le?(t=e._id,e=e._name):(t=ir(),(n=I1).time=He(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],o=s.length,f,l=0;l<o;++l)(f=s[l])&&rt(f,e,t,l,s,n||E1(f,t));return new le(r,this._parents,e,t)}we.prototype.interrupt=Mo;we.prototype.transition=B1;var at=e=>()=>e;function C1(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function he(e,t,n){this.k=e,this.x=t,this.y=n}he.prototype={constructor:he,scale:function(e){return e===1?this:new he(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new he(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var zt=new he(1,0,0);k1.prototype=he.prototype;function k1(e){for(;!e.__zoom;)if(!(e=e.parentNode))return zt;return e.__zoom}function Tt(e){e.stopImmediatePropagation()}function De(e){e.preventDefault(),e.stopImmediatePropagation()}function R1(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function F1(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ar(){return this.__zoom||zt}function S1(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function N1(){return navigator.maxTouchPoints||"ontouchstart"in this}function $1(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function sr(){var e=R1,t=F1,n=$1,r=S1,i=N1,a=[0,Infinity],s=[[-Infinity,-Infinity],[Infinity,Infinity]],o=250,f=wo,l=ge("start","zoom","end"),h,c,u,d=500,v=150,m=0,p=10;function w(A){A.property("__zoom",ar).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",N).filter(i).on("touchstart.zoom",$).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(A,g,y,b){var B=A.selection?A.selection():A;B.property("__zoom",ar),A!==B?_(A,g,y,b):B.interrupt().each(function(){E(this,arguments).event(b).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},w.scaleBy=function(A,g,y,b){w.scaleTo(A,function(){var B=this.__zoom.k,k=typeof g=="function"?g.apply(this,arguments):g;return B*k},y,b)},w.scaleTo=function(A,g,y,b){w.transform(A,function(){var B=t.apply(this,arguments),k=this.__zoom,z=y==null?x(B):typeof y=="function"?y.apply(this,arguments):y,T=k.invert(z),D=typeof g=="function"?g.apply(this,arguments):g;return n(I(M(k,D),z,T),B,s)},y,b)},w.translateBy=function(A,g,y,b){w.transform(A,function(){return n(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof y=="function"?y.apply(this,arguments):y),t.apply(this,arguments),s)},null,b)},w.translateTo=function(A,g,y,b,B){w.transform(A,function(){var k=t.apply(this,arguments),z=this.__zoom,T=b==null?x(k):typeof b=="function"?b.apply(this,arguments):b;return n(zt.translate(T[0],T[1]).scale(z.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof y=="function"?-y.apply(this,arguments):-y),k,s)},b,B)};function M(A,g){return g=Math.max(a[0],Math.min(a[1],g)),g===A.k?A:new he(g,A.x,A.y)}function I(A,g,y){var b=g[0]-y[0]*A.k,B=g[1]-y[1]*A.k;return b===A.x&&B===A.y?A:new he(A.k,b,B)}function x(A){return[(+A[0][0]+ +A[1][0])/2,(+A[0][1]+ +A[1][1])/2]}function _(A,g,y,b){A.on("start.zoom",function(){E(this,arguments).event(b).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(b).end()}).tween("zoom",function(){var B=this,k=arguments,z=E(B,k).event(b),T=t.apply(B,k),D=y==null?x(T):typeof y=="function"?y.apply(B,k):y,P=Math.max(T[1][0]-T[0][0],T[1][1]-T[0][1]),Q=B.__zoom,j=typeof g=="function"?g.apply(B,k):g,J=f(Q.invert(D).concat(P/Q.k),j.invert(D).concat(P/j.k));return function(ee){if(ee===1)ee=j;else{var se=J(ee),ht=P/se[2];ee=new he(ht,D[0]-se[0]*ht,D[1]-se[1]*ht)}z.zoom(null,ee)}})}function E(A,g,y){return!y&&A.__zooming||new F(A,g)}function F(A,g){this.that=A,this.args=g,this.active=0,this.sourceEvent=null,this.extent=t.apply(A,g),this.taps=0}F.prototype={event:function(A){return A&&(this.sourceEvent=A),this},start:function(){return++this.active==1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(A,g){return this.mouse&&A!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&A!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&A!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active==0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(A){var g=H(this.that).datum();l.call(A,this.that,new C1(A,{sourceEvent:this.sourceEvent,target:w,type:A,transform:this.that.__zoom,dispatch:l}),g)}};function R(A,...g){if(!e.apply(this,arguments))return;var y=E(this,g).event(A),b=this.__zoom,B=Math.max(a[0],Math.min(a[1],b.k*Math.pow(2,r.apply(this,arguments)))),k=te(A);if(y.wheel)(y.mouse[0][0]!==k[0]||y.mouse[0][1]!==k[1])&&(y.mouse[1]=b.invert(y.mouse[0]=k)),clearTimeout(y.wheel);else{if(b.k===B)return;y.mouse=[k,b.invert(k)],it(this),y.start()}De(A),y.wheel=setTimeout(z,v),y.zoom("mouse",n(I(M(b,B),y.mouse[0],y.mouse[1]),y.extent,s));function z(){y.wheel=null,y.end()}}function S(A,...g){if(u||!e.apply(this,arguments))return;var y=A.currentTarget,b=E(this,g,!0).event(A),B=H(A.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",P,!0),k=te(A,y),z=A.clientX,T=A.clientY;Ke(A.view),Tt(A),b.mouse=[k,this.__zoom.invert(k)],it(this),b.start();function D(Q){if(De(Q),!b.moved){var j=Q.clientX-z,J=Q.clientY-T;b.moved=j*j+J*J>m}b.event(Q).zoom("mouse",n(I(b.that.__zoom,b.mouse[0]=te(Q,y),b.mouse[1]),b.extent,s))}function P(Q){B.on("mousemove.zoom mouseup.zoom",null),Je(Q.view,b.moved),De(Q),b.event(Q).end()}}function N(A,...g){if(!!e.apply(this,arguments)){var y=this.__zoom,b=te(A.changedTouches?A.changedTouches[0]:A,this),B=y.invert(b),k=y.k*(A.shiftKey?.5:2),z=n(I(M(y,k),b,B),t.apply(this,g),s);De(A),o>0?H(this).transition().duration(o).call(_,z,b,A):H(this).call(w.transform,z,b,A)}}function $(A,...g){if(!!e.apply(this,arguments)){var y=A.touches,b=y.length,B=E(this,g,A.changedTouches.length===b).event(A),k,z,T,D;for(Tt(A),z=0;z<b;++z)T=y[z],D=te(T,this),D=[D,this.__zoom.invert(D),T.identifier],B.touch0?!B.touch1&&B.touch0[2]!==D[2]&&(B.touch1=D,B.taps=0):(B.touch0=D,k=!0,B.taps=1+!!h);h&&(h=clearTimeout(h)),k&&(B.taps<2&&(c=D[0],h=setTimeout(function(){h=null},d)),it(this),B.start())}}function L(A,...g){if(!!this.__zooming){var y=E(this,g).event(A),b=A.changedTouches,B=b.length,k,z,T,D;for(De(A),k=0;k<B;++k)z=b[k],T=te(z,this),y.touch0&&y.touch0[2]===z.identifier?y.touch0[0]=T:y.touch1&&y.touch1[2]===z.identifier&&(y.touch1[0]=T);if(z=y.that.__zoom,y.touch1){var P=y.touch0[0],Q=y.touch0[1],j=y.touch1[0],J=y.touch1[1],ee=(ee=j[0]-P[0])*ee+(ee=j[1]-P[1])*ee,se=(se=J[0]-Q[0])*se+(se=J[1]-Q[1])*se;z=M(z,Math.sqrt(ee/se)),T=[(P[0]+j[0])/2,(P[1]+j[1])/2],D=[(Q[0]+J[0])/2,(Q[1]+J[1])/2]}else if(y.touch0)T=y.touch0[0],D=y.touch0[1];else return;y.zoom("touch",n(I(z,T,D),y.extent,s))}}function C(A,...g){if(!!this.__zooming){var y=E(this,g).event(A),b=A.changedTouches,B=b.length,k,z;for(Tt(A),u&&clearTimeout(u),u=setTimeout(function(){u=null},d),k=0;k<B;++k)z=b[k],y.touch0&&y.touch0[2]===z.identifier?delete y.touch0:y.touch1&&y.touch1[2]===z.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&(z=te(z,this),Math.hypot(c[0]-z[0],c[1]-z[1])<p)){var T=H(this).on("dblclick.zoom");T&&T.apply(this,arguments)}}}return w.wheelDelta=function(A){return arguments.length?(r=typeof A=="function"?A:at(+A),w):r},w.filter=function(A){return arguments.length?(e=typeof A=="function"?A:at(!!A),w):e},w.touchable=function(A){return arguments.length?(i=typeof A=="function"?A:at(!!A),w):i},w.extent=function(A){return arguments.length?(t=typeof A=="function"?A:at([[+A[0][0],+A[0][1]],[+A[1][0],+A[1][1]]]),w):t},w.scaleExtent=function(A){return arguments.length?(a[0]=+A[0],a[1]=+A[1],w):[a[0],a[1]]},w.translateExtent=function(A){return arguments.length?(s[0][0]=+A[0][0],s[1][0]=+A[1][0],s[0][1]=+A[0][1],s[1][1]=+A[1][1],w):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},w.constrain=function(A){return arguments.length?(n=A,w):n},w.duration=function(A){return arguments.length?(o=+A,w):o},w.interpolate=function(A){return arguments.length?(f=A,w):f},w.on=function(){var A=l.on.apply(l,arguments);return A===l?w:A},w.clickDistance=function(A){return arguments.length?(m=(A=+A)*A,w):Math.sqrt(m)},w.tapDistance=function(A){return arguments.length?(p=+A,w):p},w}var st=e=>()=>e;function Dt(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:a,x:s,y:o,dx:f,dy:l,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:h}})}Dt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function z1(e){return!e.ctrlKey&&!e.button}function T1(){return this.parentNode}function D1(e,t){return t??{x:e.x,y:e.y}}function L1(){return navigator.maxTouchPoints||"ontouchstart"in this}function or(){var e=z1,t=T1,n=D1,r=L1,i={},a=ge("start","drag","end"),s=0,o,f,l,h,c=0;function u(x){x.on("mousedown.drag",d).filter(r).on("touchstart.drag",p).on("touchmove.drag",w,Hn).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(x,_){if(!(h||!e.call(this,x,_))){var E=I(this,t.call(this,x,_),x,_,"mouse");!E||(H(x.view).on("mousemove.drag",v,Me).on("mouseup.drag",m,Me),Ke(x.view),Ze(x),l=!1,o=x.clientX,f=x.clientY,E("start",x))}}function v(x){if(me(x),!l){var _=x.clientX-o,E=x.clientY-f;l=_*_+E*E>c}i.mouse("drag",x)}function m(x){H(x.view).on("mousemove.drag mouseup.drag",null),Je(x.view,l),me(x),i.mouse("end",x)}function p(x,_){if(!!e.call(this,x,_)){var E=x.changedTouches,F=t.call(this,x,_),R=E.length,S,N;for(S=0;S<R;++S)(N=I(this,F,x,_,E[S].identifier,E[S]))&&(Ze(x),N("start",x,E[S]))}}function w(x){var _=x.changedTouches,E=_.length,F,R;for(F=0;F<E;++F)(R=i[_[F].identifier])&&(me(x),R("drag",x,_[F]))}function M(x){var _=x.changedTouches,E=_.length,F,R;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),F=0;F<E;++F)(R=i[_[F].identifier])&&(Ze(x),R("end",x,_[F]))}function I(x,_,E,F,R,S){var N=a.copy(),$=te(S||E,_),L,C,A;if((A=n.call(x,new Dt("beforestart",{sourceEvent:E,target:u,identifier:R,active:s,x:$[0],y:$[1],dx:0,dy:0,dispatch:N}),F))!=null)return L=A.x-$[0]||0,C=A.y-$[1]||0,function g(y,b,B){var k=$,z;switch(y){case"start":i[R]=g,z=s++;break;case"end":delete i[R],--s;case"drag":$=te(B||b,_),z=s;break}N.call(y,x,new Dt(y,{sourceEvent:b,subject:A,target:u,identifier:R,active:z,x:$[0]+L,y:$[1]+C,dx:$[0]-k[0],dy:$[1]-k[1],dispatch:N}),F)}}return u.filter=function(x){return arguments.length?(e=typeof x=="function"?x:st(!!x),u):e},u.container=function(x){return arguments.length?(t=typeof x=="function"?x:st(x),u):t},u.subject=function(x){return arguments.length?(n=typeof x=="function"?x:st(x),u):n},u.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:st(!!x),u):r},u.on=function(){var x=a.on.apply(a,arguments);return x===a?u:x},u.clickDistance=function(x){return arguments.length?(c=(x=+x)*x,u):Math.sqrt(c)},u}var ot=function(t){Q1(t);var n=P1(t);return t.on=n.on,t.off=n.off,t.fire=n.fire,t};function P1(e){var t=Object.create(null);return{on:function(n,r,i){if(typeof r!="function")throw new Error("callback is expected to be a function");var a=t[n];return a||(a=t[n]=[]),a.push({callback:r,ctx:i}),e},off:function(n,r){var i=typeof n=="undefined";if(i)return t=Object.create(null),e;if(t[n]){var a=typeof r!="function";if(a)delete t[n];else for(var s=t[n],o=0;o<s.length;++o)s[o].callback===r&&s.splice(o,1)}return e},fire:function(n){var r=t[n];if(!r)return e;var i;arguments.length>1&&(i=Array.prototype.splice.call(arguments,1));for(var a=0;a<r.length;++a){var s=r[a];s.callback.apply(s.ctx,i)}return e}}}function Q1(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}function lt(e,t,n){return n={path:t,exports:{},require:function(r,i){return Ie(r,i??n.path)}},e(n,n.exports),n.exports}function Ie(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var ce=function(t){return t===0?"x":t===1?"y":t===2?"z":"c"+(t+1)},ue=function(t){return n;function n(r,i){let a=i&&i.indent||0,s=i&&i.join!==void 0?i.join:`
`,o=Array(a+1).join(" "),f=[];for(let l=0;l<t;++l){let h=ce(l),c=l===0?"":o;f.push(c+r.replace(/{var}/g,h))}return f.join(s)}},ft=q1,O1=lr,U1=fr,j1=hr;function q1(e,t){let n=lr(e,t),{Body:r}=new Function(n)();return r}function lr(e,t){return`
${fr(e,t)}
${hr(e)}
return {Body: Body, Vector: Vector};
`}function hr(e){let t=ue(e),n=t("{var}",{join:", "});return`
function Body(${n}) {
  this.isPinned = false;
  this.pos = new Vector(${n});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${n}) {
  ${t("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function fr(e,t){let n=ue(e),r="";return t&&(r=`${n(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${n("{var}",{join:", "})}) {
  ${r}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${n('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${n("this.{var} = v.{var};",{indent:4})}
    } else {
      ${n('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${n("this.{var} = ",{join:""})}0;
  };`}ft.generateCreateBodyFunctionBody=O1;ft.getVectorCode=U1;ft.getBodyCode=j1;var Ae=G1,Y1=cr,H1=ur,W1=dr,X1=vr,V1=gr,Z1=pr;function G1(e){let t=cr(e);return new Function(t)()}function cr(e){let t=ue(e),n=Math.pow(2,e);return`
${ur()}
${dr(e)}
${vr(e)}
${gr(e)}
${pr(e)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${s("      node.")}
      node.body = null;
      node.mass = ${t("node.mass_{var} = ",{join:""})}0;
      ${t("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${t("var d{var};",{indent:4})}
    var r; 
    ${t("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${t("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${t("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${t("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${t("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${t("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < θ, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${ce(0)} - node.min_${ce(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${t("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${a()}
        }
      }
    }

    ${t("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${t("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${t("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${t("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${t("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${t("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${t("root.min_{var} = {var}min;",{indent:4})}
    ${t("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${t("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${t("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${t("var min_{var} = node.min_{var};",{indent:8})}
        ${t("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${i(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${t("child.min_{var} = min_{var};",{indent:10})}
          ${t("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${t("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${t("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function i(o){let f=[],l=Array(o+1).join(" ");for(let h=0;h<e;++h)f.push(l+`if (${ce(h)} > max_${ce(h)}) {`),f.push(l+`  quadIdx = quadIdx + ${Math.pow(2,h)};`),f.push(l+`  min_${ce(h)} = max_${ce(h)};`),f.push(l+`  max_${ce(h)} = node.max_${ce(h)};`),f.push(l+"}");return f.join(`
`)}function a(){let o=Array(11).join(" "),f=[];for(let l=0;l<n;++l)f.push(o+`if (node.quad${l}) {`),f.push(o+`  queue[pushIdx] = node.quad${l};`),f.push(o+"  queueLength += 1;"),f.push(o+"  pushIdx += 1;"),f.push(o+"}");return f.join(`
`)}function s(o){let f=[];for(let l=0;l<n;++l)f.push(`${o}quad${l} = null;`);return f.join(`
`)}}function vr(e){let t=ue(e);return`
  function isSamePosition(point1, point2) {
    ${t("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${t("d{var} < 1e-8",{join:" && "})};
  }  
`}function pr(e){var t=Math.pow(2,e);return`
function setChild(node, idx, child) {
  ${n()}
}`;function n(){let r=[];for(let i=0;i<t;++i){let a=i===0?"  ":"  else ";r.push(`${a}if (idx === ${i}) node.quad${i} = child;`)}return r.join(`
`)}}function gr(e){return`function getChild(node, idx) {
${t()}
  return null;
}`;function t(){let n=[],r=Math.pow(2,e);for(let i=0;i<r;++i)n.push(`  if (idx === ${i}) return node.quad${i};`);return n.join(`
`)}}function dr(e){let t=ue(e),n=Math.pow(2,e);var r=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${i("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${t("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${t("this.min_{var} = 0;",{indent:2})}
  ${t("this.max_{var} = 0;",{indent:2})}
}
`;return r;function i(a){let s=[];for(let o=0;o<n;++o)s.push(`${a}quad${o} = null;`);return s.join(`
`)}}function ur(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}Ae.generateQuadTreeFunctionBody=Y1;Ae.getInsertStackCode=H1;Ae.getQuadNodeCode=W1;Ae.isSamePosition=X1;Ae.getChildBodyCode=V1;Ae.setChildBodyCode=Z1;var mr=K1,J1=Ar;function K1(e){let t=Ar(e);return new Function("bodies","settings","random",t)}function Ar(e){let t=ue(e);return`
  var boundingBox = {
    ${t("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${t("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${t("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${t("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${t("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${t("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${t("var max_{var} = -Infinity;",{indent:4})}
    ${t("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${t("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${t("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${t("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${t("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${t("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}mr.generateFunctionBody=J1;var yr=el,tl=wr;function el(e){let t=wr(e);return new Function("options",t)}function wr(e){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${ue(e)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}yr.generateCreateDragForceFunctionBody=tl;var xr=nl,rl=_r;function nl(e){let t=_r(e);return new Function("options","random",t)}function _r(e){let t=ue(e);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${t("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${t("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${t("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${t("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}xr.generateCreateSpringForceFunctionBody=rl;var br=il,al=Mr;function il(e){let t=Mr(e);return new Function("bodies","timeStep","adaptiveTimeStepWeight",t)}function Mr(e){let t=ue(e);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${t("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${t("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${t("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${t("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${t("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${t("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${t("body.pos.{var} += d{var};",{indent:4})}

    ${t("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${t("t{var} * t{var}",{join:" + "})})/length;
`}br.generateIntegratorFunctionBody=al;var ol=sl;function sl(e,t,n,r){this.from=e,this.to=t,this.length=n,this.coefficient=r}var ll=Ir;function Ir(e,t){var n;if(e||(e={}),t){for(n in t)if(t.hasOwnProperty(n)){var r=e.hasOwnProperty(n),i=typeof t[n],a=!r||typeof e[n]!==i;a?e[n]=t[n]:i==="object"&&(e[n]=Ir(e[n],t[n]))}}return e}var fl=lt(function(e){e.exports=t,e.exports.random=t,e.exports.randomIterator=f;function t(l){var h=typeof l=="number"?l:+new Date;return new n(h)}function n(l){this.seed=l}n.prototype.next=o,n.prototype.nextDouble=s,n.prototype.uniform=s,n.prototype.gaussian=r;function r(){var l,h,c;do h=this.nextDouble()*2-1,c=this.nextDouble()*2-1,l=h*h+c*c;while(l>=1||l===0);return h*Math.sqrt(-2*Math.log(l)/l)}n.prototype.levy=i;function i(){var l=3/2,h=Math.pow(a(1+l)*Math.sin(Math.PI*l/2)/(a((1+l)/2)*l*Math.pow(2,(l-1)/2)),1/l);return this.gaussian()*h/Math.pow(Math.abs(this.gaussian()),1/l)}function a(l){return Math.sqrt(2*Math.PI/l)*Math.pow(1/Math.E*(l+1/(12*l-1/(10*l))),l)}function s(){var l=this.seed;return l=l+2127912214+(l<<12)&4294967295,l=(l^3345072700^l>>>19)&4294967295,l=l+374761393+(l<<5)&4294967295,l=(l+3550635116^l<<9)&4294967295,l=l+4251993797+(l<<3)&4294967295,l=(l^3042594569^l>>>16)&4294967295,this.seed=l,(l&268435455)/268435456}function o(l){return Math.floor(this.nextDouble()*l)}function f(l,h){var c=h||t();if(typeof c.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:d,shuffle:u};function u(){var v,m,p;for(v=l.length-1;v>0;--v)m=c.next(v+1),p=l[m],l[m]=l[v],l[v]=p;return l}function d(v){var m,p,w;for(m=l.length-1;m>0;--m)p=c.next(m+1),w=l[p],l[p]=l[m],l[m]=w,v(w);l.length&&v(l[0])}}}),Er=hl,Br={};function hl(e){var t=ol,n=ll,r=ot;if(e){if(e.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(e.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}e=n(e,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var i=Br[e.dimensions];if(!i){var a=e.dimensions;i={Body:ft(a,e.debug),createQuadTree:Ae(a),createBounds:mr(a),createDragForce:yr(a),createSpringForce:xr(a),integrate:br(a)},Br[a]=i}var s=i.Body,o=i.createQuadTree,f=i.createBounds,l=i.createDragForce,h=i.createSpringForce,c=i.integrate,u=g=>new s(g),d=fl.random(42),v=[],m=[],p=o(e,d),w=f(v,e,d),M=h(e,d),I=l(e),x=0,_=[],E=new Map,F=0;N("nbody",C),N("spring",A);var R={bodies:v,quadTree:p,springs:m,settings:e,addForce:N,removeForce:$,getForces:L,step:function(){for(var g=0;g<_.length;++g)_[g](F);var y=c(v,e.timeStep,e.adaptiveTimeStepWeight);return F+=1,y},addBody:function(g){if(!g)throw new Error("Body is required");return v.push(g),g},addBodyAt:function(g){if(!g)throw new Error("Body position is required");var y=u(g);return v.push(y),y},removeBody:function(g){if(!!g){var y=v.indexOf(g);if(!(y<0))return v.splice(y,1),v.length===0&&w.reset(),!0}},addSpring:function(g,y,b,B){if(!g||!y)throw new Error("Cannot add null spring to force simulator");typeof b!="number"&&(b=-1);var k=new t(g,y,b,B>=0?B:-1);return m.push(k),k},getTotalMovement:function(){return x},removeSpring:function(g){if(!!g){var y=m.indexOf(g);if(y>-1)return m.splice(y,1),!0}},getBestNewBodyPosition:function(g){return w.getBestNewPosition(g)},getBBox:S,getBoundingBox:S,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(g){return g!==void 0?(e.gravity=g,p.options({gravity:g}),this):e.gravity},theta:function(g){return g!==void 0?(e.theta=g,p.options({theta:g}),this):e.theta},random:d};return cl(e,R),r(R),R;function S(){return w.update(),w.box}function N(g,y){if(E.has(g))throw new Error("Force "+g+" is already added");E.set(g,y),_.push(y)}function $(g){var y=_.indexOf(E.get(g));y<0||(_.splice(y,1),E.delete(g))}function L(){return E}function C(){if(v.length!==0){p.insertBodies(v);for(var g=v.length;g--;){var y=v[g];y.isPinned||(y.reset(),p.updateBodyForce(y),I.update(y))}}}function A(){for(var g=m.length;g--;)M.update(m[g])}}function cl(e,t){for(var n in e)ul(e,t,n)}function ul(e,t,n){if(!!e.hasOwnProperty(n)&&typeof t[n]!="function"){var r=Number.isFinite(e[n]);r?t[n]=function(i){if(i!==void 0){if(!Number.isFinite(i))throw new Error("Value of "+n+" should be a valid number.");return e[n]=i,t}return e[n]}:t[n]=function(i){return i!==void 0?(e[n]=i,t):e[n]}}}var vl=dl,gl=Er;function dl(e,t){if(!e)throw new Error("Graph structure cannot be undefined");var n=t&&t.createSimulator||Er,r=n(t);if(Array.isArray(t))throw new Error("Physics settings is expected to be an object");var i=L;t&&typeof t.nodeMass=="function"&&(i=t.nodeMass);var a=new Map,s={},o=0,f=r.settings.springTransform||pl;I(),p();var l=!1,h={step:function(){if(o===0)return c(!0),!0;var C=r.step();h.lastMove=C,h.fire("step");var A=C/o,g=A<=.01;return c(g),g},getNodePosition:function(C){return $(C).pos},setNodePosition:function(C){var A=$(C);A.setPosition.apply(A,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(C){var A=s[C];if(A)return{from:A.from.pos,to:A.to.pos}},getGraphRect:function(){return r.getBBox()},forEachBody:u,pinNode:function(C,A){var g=$(C.id);g.isPinned=!!A},isNodePinned:function(C){return $(C.id).isPinned},dispose:function(){e.off("changed",M),h.fire("disposed")},getBody:m,getSpring:v,getForceVectorLength:d,simulator:r,graph:e,lastMove:0};return ot(h),h;function c(C){l!==C&&(l=C,w(C))}function u(C){a.forEach(C)}function d(){var C=0,A=0;return u(function(g){C+=Math.abs(g.force.x),A+=Math.abs(g.force.y)}),Math.sqrt(C*C+A*A)}function v(C,A){var g;if(A===void 0)typeof C!="object"?g=C:g=C.id;else{var y=e.hasLink(C,A);if(!y)return;g=y.id}return s[g]}function m(C){return a.get(C)}function p(){e.on("changed",M)}function w(C){h.fire("stable",C)}function M(C){for(var A=0;A<C.length;++A){var g=C[A];g.changeType==="add"?(g.node&&x(g.node.id),g.link&&E(g.link)):g.changeType==="remove"&&(g.node&&_(g.node),g.link&&F(g.link))}o=e.getNodesCount()}function I(){o=0,e.forEachNode(function(C){x(C.id),o+=1}),e.forEachLink(E)}function x(C){var A=a.get(C);if(!A){var g=e.getNode(C);if(!g)throw new Error("initBody() was called with unknown node id");var y=g.position;if(!y){var b=R(g);y=r.getBestNewBodyPosition(b)}A=r.addBodyAt(y),A.id=C,a.set(C,A),S(C),N(g)&&(A.isPinned=!0)}}function _(C){var A=C.id,g=a.get(A);g&&(a.delete(A),r.removeBody(g))}function E(C){S(C.fromId),S(C.toId);var A=a.get(C.fromId),g=a.get(C.toId),y=r.addSpring(A,g,C.length);f(C,y),s[C.id]=y}function F(C){var A=s[C.id];if(A){var g=e.getNode(C.fromId),y=e.getNode(C.toId);g&&S(g.id),y&&S(y.id),delete s[C.id],r.removeSpring(A)}}function R(C){var A=[];if(!C.links)return A;for(var g=Math.min(C.links.length,2),y=0;y<g;++y){var b=C.links[y],B=b.fromId!==C.id?a.get(b.fromId):a.get(b.toId);B&&B.pos&&A.push(B)}return A}function S(C){var A=a.get(C);if(A.mass=i(C),Number.isNaN(A.mass))throw new Error("Node mass should be a number")}function N(C){return C&&(C.isPinned||C.data&&C.data.isPinned)}function $(C){var A=a.get(C);return A||(x(C),A=a.get(C)),A}function L(C){var A=e.getLinks(C);return A?1+A.length/3:1}}function pl(){}vl.simulator=gl;function ml(e){var t=+this._x.call(null,e);return Cr(this.cover(t),t,e)}function Cr(e,t,n){if(isNaN(t))return e;var r,i=e._root,a={data:n},s=e._x0,o=e._x1,f,l,h,c,u;if(!i)return e._root=a,e;for(;i.length;)if((h=t>=(f=(s+o)/2))?s=f:o=f,r=i,!(i=i[c=+h]))return r[c]=a,e;if(l=+e._x.call(null,i.data),t===l)return a.next=i,r?r[c]=a:e._root=a,e;do r=r?r[c]=new Array(2):e._root=new Array(2),(h=t>=(f=(s+o)/2))?s=f:o=f;while((c=+h)==(u=+(l>=f)));return r[u]=i,r[c]=a,e}function Al(e){var t,n=e.length,r,i=new Array(n),a=Infinity,s=-Infinity;for(t=0;t<n;++t)isNaN(r=+this._x.call(null,e[t]))||(i[t]=r,r<a&&(a=r),r>s&&(s=r));if(a>s)return this;for(this.cover(a).cover(s),t=0;t<n;++t)Cr(this,i[t],e[t]);return this}function yl(e){if(isNaN(e=+e))return this;var t=this._x0,n=this._x1;if(isNaN(t))n=(t=Math.floor(e))+1;else{for(var r=n-t||1,i=this._root,a,s;t>e||e>=n;)switch(s=+(e<t),a=new Array(2),a[s]=i,i=a,r*=2,s){case 0:n=t+r;break;case 1:t=n-r;break}this._root&&this._root.length&&(this._root=i)}return this._x0=t,this._x1=n,this}function wl(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function xl(e){return arguments.length?this.cover(+e[0][0]).cover(+e[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function de(e,t,n){this.node=e,this.x0=t,this.x1=n}function _l(e,t){var n,r=this._x0,i,a,s=this._x1,o=[],f=this._root,l,h;for(f&&o.push(new de(f,r,s)),t==null?t=Infinity:(r=e-t,s=e+t);l=o.pop();)if(!(!(f=l.node)||(i=l.x0)>s||(a=l.x1)<r))if(f.length){var c=(i+a)/2;o.push(new de(f[1],c,a),new de(f[0],i,c)),(h=+(e>=c))&&(l=o[o.length-1],o[o.length-1]=o[o.length-1-h],o[o.length-1-h]=l)}else{var u=Math.abs(e-+this._x.call(null,f.data));u<t&&(t=u,r=e-u,s=e+u,n=f.data)}return n}function bl(e){if(isNaN(f=+this._x.call(null,e)))return this;var t,n=this._root,r,i,a,s=this._x0,o=this._x1,f,l,h,c,u;if(!n)return this;if(n.length)for(;;){if((h=f>=(l=(s+o)/2))?s=l:o=l,t=n,!(n=n[c=+h]))return this;if(!n.length)break;t[c+1&1]&&(r=t,u=c)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[c]=a:delete t[c],(n=t[0]||t[1])&&n===(t[1]||t[0])&&!n.length&&(r?r[u]=n:this._root=n),this):(this._root=a,this)}function Ml(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Il(){return this._root}function El(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Bl(e){var t=[],n,r=this._root,i,a,s;for(r&&t.push(new de(r,this._x0,this._x1));n=t.pop();)if(!e(r=n.node,a=n.x0,s=n.x1)&&r.length){var o=(a+s)/2;(i=r[1])&&t.push(new de(i,o,s)),(i=r[0])&&t.push(new de(i,a,o))}return this}function Cl(e){var t=[],n=[],r;for(this._root&&t.push(new de(this._root,this._x0,this._x1));r=t.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.x1,f=(s+o)/2;(a=i[0])&&t.push(new de(a,s,f)),(a=i[1])&&t.push(new de(a,f,o))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.x1);return this}function kl(e){return e[0]}function Rl(e){return arguments.length?(this._x=e,this):this._x}function Fl(e,t){var n=new Lt(t??kl,NaN,NaN);return e==null?n:n.addAll(e)}function Lt(e,t,n){this._x=e,this._x0=t,this._x1=n,this._root=void 0}function kr(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var V=Fl.prototype=Lt.prototype;V.copy=function(){var e=new Lt(this._x,this._x0,this._x1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=kr(t),e;for(n=[{source:t,target:e._root=new Array(2)}];t=n.pop();)for(var i=0;i<2;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(2)}):t.target[i]=kr(r));return e};V.add=ml;V.addAll=Al;V.cover=yl;V.data=wl;V.extent=xl;V.find=_l;V.remove=bl;V.removeAll=Ml;V.root=Il;V.size=El;V.visit=Bl;V.visitAfter=Cl;V.x=Rl;function Sl(e){let t=+this._x.call(null,e),n=+this._y.call(null,e);return Rr(this.cover(t,n),t,n,e)}function Rr(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,s={data:r},o=e._x0,f=e._y0,l=e._x1,h=e._y1,c,u,d,v,m,p,w,M;if(!a)return e._root=s,e;for(;a.length;)if((m=t>=(c=(o+l)/2))?o=c:l=c,(p=n>=(u=(f+h)/2))?f=u:h=u,i=a,!(a=a[w=p<<1|m]))return i[w]=s,e;if(d=+e._x.call(null,a.data),v=+e._y.call(null,a.data),t===d&&n===v)return s.next=a,i?i[w]=s:e._root=s,e;do i=i?i[w]=new Array(4):e._root=new Array(4),(m=t>=(c=(o+l)/2))?o=c:l=c,(p=n>=(u=(f+h)/2))?f=u:h=u;while((w=p<<1|m)==(M=(v>=u)<<1|d>=c));return i[M]=a,i[w]=s,e}function Nl(e){var t,n,r=e.length,i,a,s=new Array(r),o=new Array(r),f=Infinity,l=Infinity,h=-Infinity,c=-Infinity;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(s[n]=i,o[n]=a,i<f&&(f=i),i>h&&(h=i),a<l&&(l=a),a>c&&(c=a));if(f>h||l>c)return this;for(this.cover(f,l).cover(h,c),n=0;n<r;++n)Rr(this,s[n],o[n],e[n]);return this}function $l(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var s=i-n||1,o=this._root,f,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,f=new Array(4),f[l]=o,o=f,s*=2,l){case 0:i=n+s,a=r+s;break;case 1:n=i-s,a=r+s;break;case 2:i=n+s,r=a-s;break;case 3:n=i-s,r=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function zl(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Tl(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function W(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Dl(e,t,n){var r,i=this._x0,a=this._y0,s,o,f,l,h=this._x1,c=this._y1,u=[],d=this._root,v,m;for(d&&u.push(new W(d,i,a,h,c)),n==null?n=Infinity:(i=e-n,a=t-n,h=e+n,c=t+n,n*=n);v=u.pop();)if(!(!(d=v.node)||(s=v.x0)>h||(o=v.y0)>c||(f=v.x1)<i||(l=v.y1)<a))if(d.length){var p=(s+f)/2,w=(o+l)/2;u.push(new W(d[3],p,w,f,l),new W(d[2],s,w,p,l),new W(d[1],p,o,f,w),new W(d[0],s,o,p,w)),(m=(t>=w)<<1|e>=p)&&(v=u[u.length-1],u[u.length-1]=u[u.length-1-m],u[u.length-1-m]=v)}else{var M=e-+this._x.call(null,d.data),I=t-+this._y.call(null,d.data),x=M*M+I*I;if(x<n){var _=Math.sqrt(n=x);i=e-_,a=t-_,h=e+_,c=t+_,r=d.data}}return r}function Ll(e){if(isNaN(h=+this._x.call(null,e))||isNaN(c=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,s=this._x0,o=this._y0,f=this._x1,l=this._y1,h,c,u,d,v,m,p,w;if(!n)return this;if(n.length)for(;;){if((v=h>=(u=(s+f)/2))?s=u:f=u,(m=c>=(d=(o+l)/2))?o=d:l=d,t=n,!(n=n[p=m<<1|v]))return this;if(!n.length)break;(t[p+1&3]||t[p+2&3]||t[p+3&3])&&(r=t,w=p)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[p]=a:delete t[p],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[w]=n:this._root=n),this):(this._root=a,this)}function Pl(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Ql(){return this._root}function ql(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Ol(e){var t=[],n,r=this._root,i,a,s,o,f;for(r&&t.push(new W(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,s=n.y0,o=n.x1,f=n.y1)&&r.length){var l=(a+o)/2,h=(s+f)/2;(i=r[3])&&t.push(new W(i,l,h,o,f)),(i=r[2])&&t.push(new W(i,a,h,l,f)),(i=r[1])&&t.push(new W(i,l,s,o,h)),(i=r[0])&&t.push(new W(i,a,s,l,h))}return this}function Ul(e){var t=[],n=[],r;for(this._root&&t.push(new W(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.y0,f=r.x1,l=r.y1,h=(s+f)/2,c=(o+l)/2;(a=i[0])&&t.push(new W(a,s,o,h,c)),(a=i[1])&&t.push(new W(a,h,o,f,c)),(a=i[2])&&t.push(new W(a,s,c,h,l)),(a=i[3])&&t.push(new W(a,h,c,f,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function jl(e){return e[0]}function Gl(e){return arguments.length?(this._x=e,this):this._x}function Yl(e){return e[1]}function Hl(e){return arguments.length?(this._y=e,this):this._y}function Wl(e,t,n){var r=new Pt(t??jl,n??Yl,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Pt(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Fr(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var X=Wl.prototype=Pt.prototype;X.copy=function(){var e=new Pt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Fr(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Fr(r));return e};X.add=Sl;X.addAll=Nl;X.cover=$l;X.data=zl;X.extent=Tl;X.find=Dl;X.remove=Ll;X.removeAll=Pl;X.root=Ql;X.size=ql;X.visit=Ol;X.visitAfter=Ul;X.x=Gl;X.y=Hl;function Xl(e){var t=+this._x.call(null,e),n=+this._y.call(null,e),r=+this._z.call(null,e);return Sr(this.cover(t,n,r),t,n,r,e)}function Sr(e,t,n,r,i){if(isNaN(t)||isNaN(n)||isNaN(r))return e;var a,s=e._root,o={data:i},f=e._x0,l=e._y0,h=e._z0,c=e._x1,u=e._y1,d=e._z1,v,m,p,w,M,I,x,_,E,F,R;if(!s)return e._root=o,e;for(;s.length;)if((x=t>=(v=(f+c)/2))?f=v:c=v,(_=n>=(m=(l+u)/2))?l=m:u=m,(E=r>=(p=(h+d)/2))?h=p:d=p,a=s,!(s=s[F=E<<2|_<<1|x]))return a[F]=o,e;if(w=+e._x.call(null,s.data),M=+e._y.call(null,s.data),I=+e._z.call(null,s.data),t===w&&n===M&&r===I)return o.next=s,a?a[F]=o:e._root=o,e;do a=a?a[F]=new Array(8):e._root=new Array(8),(x=t>=(v=(f+c)/2))?f=v:c=v,(_=n>=(m=(l+u)/2))?l=m:u=m,(E=r>=(p=(h+d)/2))?h=p:d=p;while((F=E<<2|_<<1|x)==(R=(I>=p)<<2|(M>=m)<<1|w>=v));return a[R]=s,a[F]=o,e}function Vl(e){var t,n,r=e.length,i,a,s,o=new Array(r),f=new Array(r),l=new Array(r),h=Infinity,c=Infinity,u=Infinity,d=-Infinity,v=-Infinity,m=-Infinity;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t))||(o[n]=i,f[n]=a,l[n]=s,i<h&&(h=i),i>d&&(d=i),a<c&&(c=a),a>v&&(v=a),s<u&&(u=s),s>m&&(m=s));if(h>d||c>v||u>m)return this;for(this.cover(h,c,u).cover(d,v,m),n=0;n<r;++n)Sr(this,o[n],f[n],l[n],e[n]);return this}function Zl(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,f=this._z1;if(isNaN(r))s=(r=Math.floor(e))+1,o=(i=Math.floor(t))+1,f=(a=Math.floor(n))+1;else{for(var l=s-r||1,h=this._root,c,u;r>e||e>=s||i>t||t>=o||a>n||n>=f;)switch(u=(n<a)<<2|(t<i)<<1|e<r,c=new Array(8),c[u]=h,h=c,l*=2,u){case 0:s=r+l,o=i+l,f=a+l;break;case 1:r=s-l,o=i+l,f=a+l;break;case 2:s=r+l,i=o-l,f=a+l;break;case 3:r=s-l,i=o-l,f=a+l;break;case 4:s=r+l,o=i+l,a=f-l;break;case 5:r=s-l,o=i+l,a=f-l;break;case 6:s=r+l,i=o-l,a=f-l;break;case 7:r=s-l,i=o-l,a=f-l;break}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=f,this}function Kl(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Jl(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function O(e,t,n,r,i,a,s){this.node=e,this.x0=t,this.y0=n,this.z0=r,this.x1=i,this.y1=a,this.z1=s}function ef(e,t,n,r){var i,a=this._x0,s=this._y0,o=this._z0,f,l,h,c,u,d,v=this._x1,m=this._y1,p=this._z1,w=[],M=this._root,I,x;for(M&&w.push(new O(M,a,s,o,v,m,p)),r==null?r=Infinity:(a=e-r,s=t-r,o=n-r,v=e+r,m=t+r,p=n+r,r*=r);I=w.pop();)if(!(!(M=I.node)||(f=I.x0)>v||(l=I.y0)>m||(h=I.z0)>p||(c=I.x1)<a||(u=I.y1)<s||(d=I.z1)<o))if(M.length){var _=(f+c)/2,E=(l+u)/2,F=(h+d)/2;w.push(new O(M[7],_,E,F,c,u,d),new O(M[6],f,E,F,_,u,d),new O(M[5],_,l,F,c,E,d),new O(M[4],f,l,F,_,E,d),new O(M[3],_,E,h,c,u,F),new O(M[2],f,E,h,_,u,F),new O(M[1],_,l,h,c,E,F),new O(M[0],f,l,h,_,E,F)),(x=(n>=F)<<2|(t>=E)<<1|e>=_)&&(I=w[w.length-1],w[w.length-1]=w[w.length-1-x],w[w.length-1-x]=I)}else{var R=e-+this._x.call(null,M.data),S=t-+this._y.call(null,M.data),N=n-+this._z.call(null,M.data),$=R*R+S*S+N*N;if($<r){var L=Math.sqrt(r=$);a=e-L,s=t-L,o=n-L,v=e+L,m=t+L,p=n+L,i=M.data}}return i}function tf(e){if(isNaN(u=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e))||isNaN(v=+this._z.call(null,e)))return this;var t,n=this._root,r,i,a,s=this._x0,o=this._y0,f=this._z0,l=this._x1,h=this._y1,c=this._z1,u,d,v,m,p,w,M,I,x,_,E;if(!n)return this;if(n.length)for(;;){if((M=u>=(m=(s+l)/2))?s=m:l=m,(I=d>=(p=(o+h)/2))?o=p:h=p,(x=v>=(w=(f+c)/2))?f=w:c=w,t=n,!(n=n[_=x<<2|I<<1|M]))return this;if(!n.length)break;(t[_+1&7]||t[_+2&7]||t[_+3&7]||t[_+4&7]||t[_+5&7]||t[_+6&7]||t[_+7&7])&&(r=t,E=_)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[_]=a:delete t[_],(n=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&n===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[E]=n:this._root=n),this):(this._root=a,this)}function nf(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function rf(){return this._root}function af(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function sf(e){var t=[],n,r=this._root,i,a,s,o,f,l,h;for(r&&t.push(new O(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=t.pop();)if(!e(r=n.node,a=n.x0,s=n.y0,o=n.z0,f=n.x1,l=n.y1,h=n.z1)&&r.length){var c=(a+f)/2,u=(s+l)/2,d=(o+h)/2;(i=r[7])&&t.push(new O(i,c,u,d,f,l,h)),(i=r[6])&&t.push(new O(i,a,u,d,c,l,h)),(i=r[5])&&t.push(new O(i,c,s,d,f,u,h)),(i=r[4])&&t.push(new O(i,a,s,d,c,u,h)),(i=r[3])&&t.push(new O(i,c,u,o,f,l,d)),(i=r[2])&&t.push(new O(i,a,u,o,c,l,d)),(i=r[1])&&t.push(new O(i,c,s,o,f,u,d)),(i=r[0])&&t.push(new O(i,a,s,o,c,u,d))}return this}function of(e){var t=[],n=[],r;for(this._root&&t.push(new O(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=t.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.y0,f=r.z0,l=r.x1,h=r.y1,c=r.z1,u=(s+l)/2,d=(o+h)/2,v=(f+c)/2;(a=i[0])&&t.push(new O(a,s,o,f,u,d,v)),(a=i[1])&&t.push(new O(a,u,o,f,l,d,v)),(a=i[2])&&t.push(new O(a,s,d,f,u,h,v)),(a=i[3])&&t.push(new O(a,u,d,f,l,h,v)),(a=i[4])&&t.push(new O(a,s,o,v,u,d,c)),(a=i[5])&&t.push(new O(a,u,o,v,l,d,c)),(a=i[6])&&t.push(new O(a,s,d,v,u,h,c)),(a=i[7])&&t.push(new O(a,u,d,v,l,h,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function lf(e){return e[0]}function ff(e){return arguments.length?(this._x=e,this):this._x}function hf(e){return e[1]}function cf(e){return arguments.length?(this._y=e,this):this._y}function uf(e){return e[2]}function df(e){return arguments.length?(this._z=e,this):this._z}function vf(e,t,n,r){var i=new Qt(t??lf,n??hf,r??uf,NaN,NaN,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function Qt(e,t,n,r,i,a,s,o,f){this._x=e,this._y=t,this._z=n,this._x0=r,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=f,this._root=void 0}function Nr(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Y=vf.prototype=Qt.prototype;Y.copy=function(){var e=new Qt(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Nr(t),e;for(n=[{source:t,target:e._root=new Array(8)}];t=n.pop();)for(var i=0;i<8;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(8)}):t.target[i]=Nr(r));return e};Y.add=Xl;Y.addAll=Vl;Y.cover=Zl;Y.data=Kl;Y.extent=Jl;Y.find=ef;Y.remove=tf;Y.removeAll=nf;Y.root=rf;Y.size=af;Y.visit=sf;Y.visitAfter=of;Y.x=ff;Y.y=cf;Y.z=df;var yh=Math.PI*(3-Math.sqrt(5)),wh=Math.PI*20/(9+Math.sqrt(221));var gf=lt(function(e,t){(function(n){e.exports=n()})(function(){return function(){function n(r,i,a){function s(l,h){if(!i[l]){if(!r[l]){var c=typeof Ie=="function"&&Ie;if(!h&&c)return c(l,!0);if(o)return o(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var d=i[l]={exports:{}};r[l][0].call(d.exports,function(v){var m=r[l][1][v];return s(m||v)},d,d.exports,n,r,i,a)}return i[l].exports}for(var o=typeof Ie=="function"&&Ie,f=0;f<a.length;f++)s(a[f]);return s}return n}()({1:[function(n,r,i){var a=n("inherits"),s=n("multimath"),o=n("./mm_unsharp_mask"),f=n("./mm_resize");function l(h){var c=h||[],u={js:c.indexOf("js")>=0,wasm:c.indexOf("wasm")>=0};s.call(this,u),this.features={js:u.js,wasm:u.wasm&&this.has_wasm()},this.use(o),this.use(f)}a(l,s),l.prototype.resizeAndUnsharp=function(c,u){var d=this.resize(c,u);return c.unsharpAmount&&this.unsharp_mask(d,c.toWidth,c.toHeight,c.unsharpAmount,c.unsharpRadius,c.unsharpThreshold),d},r.exports=l},{"./mm_resize":4,"./mm_unsharp_mask":9,inherits:19,multimath:20}],2:[function(n,r,i){function a(f){return f<0?0:f>255?255:f}function s(f,l,h,c,u,d){var v,m,p,w,M,I,x,_,E,F,R,S=0,N=0;for(E=0;E<c;E++){for(M=0,F=0;F<u;F++){for(I=d[M++],x=d[M++],_=S+I*4|0,v=m=p=w=0;x>0;x--)R=d[M++],w=w+R*f[_+3]|0,p=p+R*f[_+2]|0,m=m+R*f[_+1]|0,v=v+R*f[_]|0,_=_+4|0;l[N+3]=a(w+(1<<13)>>14),l[N+2]=a(p+(1<<13)>>14),l[N+1]=a(m+(1<<13)>>14),l[N]=a(v+(1<<13)>>14),N=N+c*4|0}N=(E+1)*4|0,S=(E+1)*h*4|0}}function o(f,l,h,c,u,d){var v,m,p,w,M,I,x,_,E,F,R,S=0,N=0;for(E=0;E<c;E++){for(M=0,F=0;F<u;F++){for(I=d[M++],x=d[M++],_=S+I*4|0,v=m=p=w=0;x>0;x--)R=d[M++],w=w+R*f[_+3]|0,p=p+R*f[_+2]|0,m=m+R*f[_+1]|0,v=v+R*f[_]|0,_=_+4|0;l[N+3]=a(w+(1<<13)>>14),l[N+2]=a(p+(1<<13)>>14),l[N+1]=a(m+(1<<13)>>14),l[N]=a(v+(1<<13)>>14),N=N+c*4|0}N=(E+1)*4|0,S=(E+1)*h*4|0}}r.exports={convolveHorizontally:s,convolveVertically:o}},{}],3:[function(n,r,i){r.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEXA2AAAGAGf39/f39/AGAHf39/f39/fwACDwEDZW52Bm1lbW9yeQIAAAMEAwABAgYGAX8AQQALB1cFEV9fd2FzbV9jYWxsX2N0b3JzAAAIY29udm9sdmUAAQpjb252b2x2ZUhWAAIMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAK7AMDAwABC8YDAQ9/AkAgA0UNACAERQ0AA0AgDCENQQAhE0EAIQcDQCAHQQJqIQYCfyAHQQF0IAVqIgcuAQIiFEUEQEGAwAAhCEGAwAAhCUGAwAAhCkGAwAAhCyAGDAELIBIgBy4BAGohCEEAIQsgFCEHQQAhDiAGIQlBACEPQQAhEANAIAUgCUEBdGouAQAiESAAIAhBAnRqKAIAIgpBGHZsIBBqIRAgCkH/AXEgEWwgC2ohCyAKQRB2Qf8BcSARbCAPaiEPIApBCHZB/wFxIBFsIA5qIQ4gCEEBaiEIIAlBAWohCSAHQQFrIgcNAAsgC0GAQGshCCAOQYBAayEJIA9BgEBrIQogEEGAQGshCyAGIBRqCyEHIAEgDUECdGogCUEOdSIGQf8BIAZB/wFIGyIGQQAgBkEAShtBCHRBgP4DcSAKQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EQdEGAgPwHcSALQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobcjYCACADIA1qIQ0gE0EBaiITIARHDQALIAxBAWoiDCACbCESIAMgDEcNAAsLCx4AQQAgAiADIAQgBSAAEAEgAkEAIAQgBSAGIAEQAQs="},{}],4:[function(n,r,i){r.exports={name:"resize",fn:n("./resize"),wasm_fn:n("./resize_wasm"),wasm_src:n("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(n,r,i){var a=n("./resize_filter_gen"),s=n("./convolve").convolveHorizontally,o=n("./convolve").convolveVertically;function f(l,h,c){for(var u=3,d=h*c*4|0;u<d;)l[u]=255,u=u+4|0}r.exports=function(h){var c=h.src,u=h.width,d=h.height,v=h.toWidth,m=h.toHeight,p=h.scaleX||h.toWidth/h.width,w=h.scaleY||h.toHeight/h.height,M=h.offsetX||0,I=h.offsetY||0,x=h.dest||new Uint8Array(v*m*4),_=typeof h.quality=="undefined"?3:h.quality,E=h.alpha||!1,F=a(_,u,v,p,M),R=a(_,d,m,w,I),S=new Uint8Array(v*d*4);return s(c,S,u,d,v,F),o(S,x,d,v,m,R),E||f(x,v,m),x}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(n,r,i){var a=n("./resize_filter_info"),s=14;function o(f){return Math.round(f*((1<<s)-1))}r.exports=function(l,h,c,u,d){var v=a[l].filter,m=1/u,p=Math.min(1,u),w=a[l].win/p,M,I,x,_,E,F,R,S,N,$,L,C,A,g,y,b,B,k=Math.floor((w+1)*2),z=new Int16Array((k+2)*c),T=0,D=!z.subarray||!z.set;for(M=0;M<c;M++){for(I=(M+.5)*m+d,x=Math.max(0,Math.floor(I-w)),_=Math.min(h-1,Math.ceil(I+w)),E=_-x+1,F=new Float32Array(E),R=new Int16Array(E),S=0,N=x,$=0;N<=_;N++,$++)L=v((N+.5-I)*p),S+=L,F[$]=L;for(C=0,$=0;$<F.length;$++)A=F[$]/S,C+=A,R[$]=o(A);for(R[c>>1]+=o(1-C),g=0;g<R.length&&R[g]===0;)g++;if(g<R.length){for(y=R.length-1;y>0&&R[y]===0;)y--;if(b=x+g,B=y-g+1,z[T++]=b,z[T++]=B,!D)z.set(R.subarray(g,y+1),T),T+=B;else for($=g;$<=y;$++)z[T++]=R[$]}else z[T++]=0,z[T++]=0}return z}},{"./resize_filter_info":7}],7:[function(n,r,i){r.exports=[{win:.5,filter:function(s){return s>=-.5&&s<.5?1:0}},{win:1,filter:function(s){if(s<=-1||s>=1)return 0;if(s>-11920929e-14&&s<11920929e-14)return 1;var o=s*Math.PI;return Math.sin(o)/o*(.54+.46*Math.cos(o/1))}},{win:2,filter:function(s){if(s<=-2||s>=2)return 0;if(s>-11920929e-14&&s<11920929e-14)return 1;var o=s*Math.PI;return Math.sin(o)/o*Math.sin(o/2)/(o/2)}},{win:3,filter:function(s){if(s<=-3||s>=3)return 0;if(s>-11920929e-14&&s<11920929e-14)return 1;var o=s*Math.PI;return Math.sin(o)/o*Math.sin(o/3)/(o/3)}}]},{}],8:[function(n,r,i){var a=n("./resize_filter_gen");function s(h,c,u){for(var d=3,v=c*u*4|0;d<v;)h[d]=255,d=d+4|0}function o(h){return new Uint8Array(h.buffer,0,h.byteLength)}var f=!0;try{f=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch(h){}function l(h,c,u){if(f){c.set(o(h),u);return}for(var d=u,v=0;v<h.length;v++){var m=h[v];c[d++]=m&255,c[d++]=m>>8&255}}r.exports=function(c){var u=c.src,d=c.width,v=c.height,m=c.toWidth,p=c.toHeight,w=c.scaleX||c.toWidth/c.width,M=c.scaleY||c.toHeight/c.height,I=c.offsetX||0,x=c.offsetY||0,_=c.dest||new Uint8Array(m*p*4),E=typeof c.quality=="undefined"?3:c.quality,F=c.alpha||!1,R=a(E,d,m,w,I),S=a(E,v,p,M,x),N=0,$=this.__align(N+Math.max(u.byteLength,_.byteLength)),L=this.__align($+v*m*4),C=this.__align(L+R.byteLength),A=C+S.byteLength,g=this.__instance("resize",A),y=new Uint8Array(this.__memory.buffer),b=new Uint32Array(this.__memory.buffer),B=new Uint32Array(u.buffer);b.set(B),l(R,y,L),l(S,y,C);var k=g.exports.convolveHV||g.exports._convolveHV;k(L,C,$,d,v,m,p);var z=new Uint32Array(_.buffer);return z.set(new Uint32Array(this.__memory.buffer,0,p*m)),F||s(_,m,p),_}},{"./resize_filter_gen":6}],9:[function(n,r,i){r.exports={name:"unsharp_mask",fn:n("./unsharp_mask"),wasm_fn:n("./unsharp_mask_wasm"),wasm_src:n("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(n,r,i){var a=n("glur/mono16");function s(o,f,l){for(var h=f*l,c=new Uint16Array(h),u,d,v,m,p=0;p<h;p++)u=o[4*p],d=o[4*p+1],v=o[4*p+2],m=u>=d&&u>=v?u:d>=v&&d>=u?d:v,c[p]=m<<8;return c}r.exports=function(f,l,h,c,u,d){var v,m,p,w,M;if(!(c===0||u<.5)){u>2&&(u=2);var I=s(f,l,h),x=new Uint16Array(I);a(x,l,h,u);for(var _=c/100*4096+.5|0,E=d<<8,F=l*h,R=0;R<F;R++)v=I[R],w=v-x[R],Math.abs(w)>=E&&(m=v+(_*w+2048>>12),m=m>65280?65280:m,m=m<0?0:m,v=v!==0?v:1,p=(m<<12)/v|0,M=R*4,f[M]=f[M]*p+2048>>12,f[M+1]=f[M+1]*p+2048>>12,f[M+2]=f[M+2]*p+2048>>12)}}},{"glur/mono16":18}],11:[function(n,r,i){r.exports=function(s,o,f,l,h,c){if(!(l===0||h<.5)){h>2&&(h=2);var u=o*f,d=u*4,v=u*2,m=u*2,p=Math.max(o,f)*4,w=8*4,M=0,I=d,x=I+v,_=x+m,E=_+m,F=E+p,R=this.__instance("unsharp_mask",d+v+m*2+p+w,{exp:Math.exp}),S=new Uint32Array(s.buffer),N=new Uint32Array(this.__memory.buffer);N.set(S);var $=R.exports.hsv_v16||R.exports._hsv_v16;$(M,I,o,f),$=R.exports.blurMono16||R.exports._blurMono16,$(I,x,_,E,F,o,f,h),$=R.exports.unsharp||R.exports._unsharp,$(M,M,I,x,o,f,l,c),S.set(new Uint32Array(this.__memory.buffer,0,u))}}},{}],12:[function(n,r,i){r.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAE0B2AAAGAEf39/fwBgBn9/f39/fwBgCH9/f39/f39/AGAIf39/f39/f30AYAJ9fwBgAXwBfAIZAgNlbnYDZXhwAAYDZW52Bm1lbW9yeQIAAAMHBgAFAgQBAwYGAX8AQQALB4oBCBFfX3dhc21fY2FsbF9jdG9ycwABFl9fYnVpbGRfZ2F1c3NpYW5fY29lZnMAAg5fX2dhdXNzMTZfbGluZQADCmJsdXJNb25vMTYABAdoc3ZfdjE2AAUHdW5zaGFycAAGDF9fZHNvX2hhbmRsZQMAGF9fd2FzbV9hcHBseV9kYXRhX3JlbG9jcwABCsUMBgMAAQvWAQEHfCABRNuGukOCGvs/IAC7oyICRAAAAAAAAADAohAAIgW2jDgCFCABIAKaEAAiAyADoCIGtjgCECABRAAAAAAAAPA/IAOhIgQgBKIgAyACIAKgokQAAAAAAADwP6AgBaGjIgS2OAIAIAEgBSAEmqIiB7Y4AgwgASADIAJEAAAAAAAA8D+gIASioiIItjgCCCABIAMgAkQAAAAAAADwv6AgBKKiIgK2OAIEIAEgByAIoCAFRAAAAAAAAPA/IAahoCIDo7Y4AhwgASAEIAKgIAOjtjgCGAuGBQMGfwl8An0gAyoCDCEVIAMqAgghFiADKgIUuyERIAMqAhC7IRACQCAEQQFrIghBAEgiCQRAIAIhByAAIQYMAQsgAiAALwEAuCIPIAMqAhi7oiIMIBGiIg0gDCAQoiAPIAMqAgS7IhOiIhQgAyoCALsiEiAPoqCgoCIOtjgCACACQQRqIQcgAEECaiEGIAhFDQAgCEEBIAhBAUgbIgpBf3MhCwJ/IAQgCmtBAXFFBEAgDiENIAgMAQsgAiANIA4gEKIgFCASIAAvAQK4Ig+ioKCgIg22OAIEIAJBCGohByAAQQRqIQYgDiEMIARBAmsLIQIgC0EAIARrRg0AA0AgByAMIBGiIA0gEKIgDyAToiASIAYvAQC4Ig6ioKCgIgy2OAIAIAcgDSARoiAMIBCiIA4gE6IgEiAGLwECuCIPoqCgoCINtjgCBCAHQQhqIQcgBkEEaiEGIAJBAkohACACQQJrIQIgAA0ACwsCQCAJDQAgASAFIAhsQQF0aiIAAn8gBkECay8BACICuCINIBW7IhKiIA0gFrsiE6KgIA0gAyoCHLuiIgwgEKKgIAwgEaKgIg8gB0EEayIHKgIAu6AiDkQAAAAAAADwQWMgDkQAAAAAAAAAAGZxBEAgDqsMAQtBAAs7AQAgCEUNACAGQQRrIQZBACAFa0EBdCEBA0ACfyANIBKiIAJB//8DcbgiDSAToqAgDyIOIBCioCAMIBGioCIPIAdBBGsiByoCALugIgxEAAAAAAAA8EFjIAxEAAAAAAAAAABmcQRAIAyrDAELQQALIQMgBi8BACECIAAgAWoiACADOwEAIAZBAmshBiAIQQFKIQMgDiEMIAhBAWshCCADDQALCwvRAgIBfwd8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIglEAAAAAAAAAMCiEAAiDLaMOAIUIAQgCZoQACIKIAqgIg22OAIQIAREAAAAAAAA8D8gCqEiCyALoiAKIAkgCaCiRAAAAAAAAPA/oCAMoaMiC7Y4AgAgBCAMIAuaoiIOtjgCDCAEIAogCUQAAAAAAADwP6AgC6KiIg+2OAIIIAQgCiAJRAAAAAAAAPC/oCALoqIiCbY4AgQgBCAOIA+gIAxEAAAAAAAA8D8gDaGgIgqjtjgCHCAEIAsgCaAgCqO2OAIYIAYEQANAIAAgBSAIbEEBdGogAiAIQQF0aiADIAQgBSAGEAMgCEEBaiIIIAZHDQALCyAFRQ0AQQAhCANAIAIgBiAIbEEBdGogASAIQQF0aiADIAQgBiAFEAMgCEEBaiIIIAVHDQALCwtxAQN/IAIgA2wiBQRAA0AgASAAKAIAIgRBEHZB/wFxIgIgAiAEQQh2Qf8BcSIDIAMgBEH/AXEiBEkbIAIgA0sbIgYgBiAEIAIgBEsbIAMgBEsbQQh0OwEAIAFBAmohASAAQQRqIQAgBUEBayIFDQALCwuZAgIDfwF8IAQgBWwhBAJ/IAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6AiC5lEAAAAAAAA4EFjBEAgC6oMAQtBgICAgHgLIQUgBARAIAdBCHQhCUEAIQYDQCAJIAIgBkEBdCIHai8BACIBIAMgB2ovAQBrIgcgB0EfdSIIaiAIc00EQCAAIAZBAnQiCGoiCiAFIAdsQYAQakEMdSABaiIHQYD+AyAHQYD+A0gbIgdBACAHQQBKG0EMdCABQQEgARtuIgEgCi0AAGxBgBBqQQx2OgAAIAAgCEEBcmoiByABIActAABsQYAQakEMdjoAACAAIAhBAnJqIgcgASAHLQAAbEGAEGpBDHY6AAALIAZBAWoiBiAERw0ACwsL"},{}],13:[function(n,r,i){var a=100;function s(o,f){this.create=o,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=f||2e3}s.prototype.acquire=function(){var o=this,f;return this.available.length!==0?f=this.available.pop():(f=this.create(),f.id=this.lastId++,f.release=function(){return o.release(f)}),this.acquired[f.id]=f,f},s.prototype.release=function(o){var f=this;delete this.acquired[o.id],o.lastUsed=Date.now(),this.available.push(o),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return f.gc()},a))},s.prototype.gc=function(){var o=this,f=Date.now();this.available=this.available.filter(function(l){return f-l.lastUsed>o.idle?(l.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return o.gc()},a):this.timeoutId=0},r.exports=s},{}],14:[function(n,r,i){var a=2;r.exports=function(o,f,l,h,c,u){var d=l/o,v=h/f,m=(2*u+a+1)/c;if(m>.5)return[[l,h]];var p=Math.ceil(Math.log(Math.min(d,v))/Math.log(m));if(p<=1)return[[l,h]];for(var w=[],M=0;M<p;M++){var I=Math.round(Math.pow(Math.pow(o,p-M-1)*Math.pow(l,M+1),1/p)),x=Math.round(Math.pow(Math.pow(f,p-M-1)*Math.pow(h,M+1),1/p));w.push([I,x])}return w}},{}],15:[function(n,r,i){var a=1e-5;function s(f){var l=Math.round(f);return Math.abs(f-l)<a?l:Math.floor(f)}function o(f){var l=Math.round(f);return Math.abs(f-l)<a?l:Math.ceil(f)}r.exports=function(l){var h=l.toWidth/l.width,c=l.toHeight/l.height,u=s(l.srcTileSize*h)-2*l.destTileBorder,d=s(l.srcTileSize*c)-2*l.destTileBorder;if(u<1||d<1)throw new Error("Internal error in pica: target tile width/height is too small.");var v,m,p,w,M,I,x=[],_;for(w=0;w<l.toHeight;w+=d)for(p=0;p<l.toWidth;p+=u)v=p-l.destTileBorder,v<0&&(v=0),M=p+u+l.destTileBorder-v,v+M>=l.toWidth&&(M=l.toWidth-v),m=w-l.destTileBorder,m<0&&(m=0),I=w+d+l.destTileBorder-m,m+I>=l.toHeight&&(I=l.toHeight-m),_={toX:v,toY:m,toWidth:M,toHeight:I,toInnerX:p,toInnerY:w,toInnerWidth:u,toInnerHeight:d,offsetX:v/h-s(v/h),offsetY:m/c-s(m/c),scaleX:h,scaleY:c,x:s(v/h),y:s(m/c),width:o(M/h),height:o(I/c)},x.push(_);return x}},{}],16:[function(n,r,i){function a(s){return Object.prototype.toString.call(s)}r.exports.isCanvas=function(o){var f=a(o);return f==="[object HTMLCanvasElement]"||f==="[object OffscreenCanvas]"||f==="[object Canvas]"},r.exports.isImage=function(o){return a(o)==="[object HTMLImageElement]"},r.exports.isImageBitmap=function(o){return a(o)==="[object ImageBitmap]"},r.exports.limiter=function(o){var f=0,l=[];function h(){f<o&&l.length&&(f++,l.shift()())}return function(u){return new Promise(function(d,v){l.push(function(){u().then(function(m){d(m),f--,h()},function(m){v(m),f--,h()})}),h()})}},r.exports.cib_quality_name=function(o){switch(o){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},r.exports.cib_support=function(o){return Promise.resolve().then(function(){if(typeof createImageBitmap=="undefined")return!1;var f=o(100,100);return createImageBitmap(f,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(l){var h=l.width===10;return l.close(),f=null,h})}).catch(function(){return!1})},r.exports.worker_offscreen_canvas_support=function(){return new Promise(function(o,f){if(typeof OffscreenCanvas=="undefined"){o(!1);return}function l(u){if(typeof createImageBitmap=="undefined"){u.postMessage(!1);return}Promise.resolve().then(function(){var d=new OffscreenCanvas(10,10),v=d.getContext("2d");return v.rect(0,0,1,1),createImageBitmap(d,0,0,1,1)}).then(function(){return u.postMessage(!0)},function(){return u.postMessage(!1)})}var h=btoa("(".concat(l.toString(),")(self);")),c=new Worker("data:text/javascript;base64,".concat(h));c.onmessage=function(u){return o(u.data)},c.onerror=f}).then(function(o){return o},function(){return!1})},r.exports.can_use_canvas=function(o){var f=!1;try{var l=o(2,1),h=l.getContext("2d"),c=h.createImageData(2,1);c.data[0]=12,c.data[1]=23,c.data[2]=34,c.data[3]=255,c.data[4]=45,c.data[5]=56,c.data[6]=67,c.data[7]=255,h.putImageData(c,0,0),c=null,c=h.getImageData(0,0,2,1),c.data[0]===12&&c.data[1]===23&&c.data[2]===34&&c.data[3]===255&&c.data[4]===45&&c.data[5]===56&&c.data[6]===67&&c.data[7]===255&&(f=!0)}catch(u){}return f},r.exports.cib_can_use_region=function(){return new Promise(function(o){if(typeof createImageBitmap=="undefined"){o(!1);return}var f=new Image;f.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",f.onload=function(){createImageBitmap(f,0,0,f.width,f.height).then(function(l){l.width===f.width&&l.height===f.height?o(!0):o(!1)},function(){return o(!1)})},f.onerror=function(){return o(!1)}})}},{}],17:[function(n,r,i){r.exports=function(){var a=n("./mathlib"),s;onmessage=function(f){var l=f.data.opts,h=!1;if(!l.src&&l.srcBitmap){var c=new OffscreenCanvas(l.width,l.height),u=c.getContext("2d",{alpha:Boolean(l.alpha)});u.drawImage(l.srcBitmap,0,0),l.src=u.getImageData(0,0,l.width,l.height).data,c.width=c.height=0,c=null,l.srcBitmap.close(),l.srcBitmap=null,h=!0}s||(s=new a(f.data.features));var d=s.resizeAndUnsharp(l);if(h){var v=new ImageData(new Uint8ClampedArray(d),l.toWidth,l.toHeight),m=new OffscreenCanvas(l.toWidth,l.toHeight),p=m.getContext("2d",{alpha:Boolean(l.alpha)});p.putImageData(v,0,0),createImageBitmap(m).then(function(w){postMessage({bitmap:w},[w])})}else postMessage({data:d},[d.buffer])}}},{"./mathlib":1}],18:[function(n,r,i){var a,s,o,f,l,h,c,u;function d(p){p<.5&&(p=.5);var w=Math.exp(.726*.726)/p,M=Math.exp(-w),I=Math.exp(-2*w),x=(1-M)*(1-M)/(1+2*w*M-I);return a=x,s=x*(w-1)*M,o=x*(w+1)*M,f=-x*I,l=2*M,h=-I,c=(a+s)/(1-l-h),u=(o+f)/(1-l-h),new Float32Array([a,s,o,f,l,h,c,u])}function v(p,w,M,I,x,_){var E,F,R,S,N,$,L,C,A,g,y,b,B,k;for(A=0;A<_;A++){for($=A*x,L=A,C=0,E=p[$],N=E*I[6],S=N,y=I[0],b=I[1],B=I[4],k=I[5],g=0;g<x;g++)F=p[$],R=F*y+E*b+S*B+N*k,N=S,S=R,E=F,M[C]=S,C++,$++;for($--,C--,L+=_*(x-1),E=p[$],N=E*I[7],S=N,F=E,y=I[2],b=I[3],g=x-1;g>=0;g--)R=F*y+E*b+S*B+N*k,N=S,S=R,E=F,F=p[$],w[L]=M[C]+S,$--,C--,L-=_}}function m(p,w,M,I){if(!!I){var x=new Uint16Array(p.length),_=new Float32Array(Math.max(w,M)),E=d(I);v(p,x,_,E,w,M),v(x,p,_,E,M,w)}}r.exports=m},{}],19:[function(n,r,i){typeof Object.create=="function"?r.exports=function(s,o){o&&(s.super_=o,s.prototype=Object.create(o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(s,o){if(o){s.super_=o;var f=function(){};f.prototype=o.prototype,s.prototype=new f,s.prototype.constructor=s}}},{}],20:[function(n,r,i){var a=n("object-assign"),s=n("./lib/base64decode"),o=n("./lib/wa_detect"),f={js:!0,wasm:!0};function l(h){if(!(this instanceof l))return new l(h);var c=a({},f,h||{});if(this.options=c,this.__cache={},this.__init_promise=null,this.__modules=c.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}l.prototype.has_wasm=o,l.prototype.use=function(h){return this.__modules[h.name]=h,this.options.wasm&&this.has_wasm()&&h.wasm_fn?this[h.name]=h.wasm_fn:this[h.name]=h.fn,this},l.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var h=this;return this.__init_promise=Promise.all(Object.keys(h.__modules).map(function(c){var u=h.__modules[c];return!h.options.wasm||!h.has_wasm()||!u.wasm_fn||h.__wasm[c]?null:WebAssembly.compile(h.__base64decode(u.wasm_src)).then(function(d){h.__wasm[c]=d})})).then(function(){return h}),this.__init_promise},l.prototype.__base64decode=s,l.prototype.__reallocate=function(c){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(c/(64*1024))}),this.__memory;var u=this.__memory.buffer.byteLength;return u<c&&this.__memory.grow(Math.ceil((c-u)/(64*1024))),this.__memory},l.prototype.__instance=function(c,u,d){if(u&&this.__reallocate(u),!this.__wasm[c]){var v=this.__modules[c];this.__wasm[c]=new WebAssembly.Module(this.__base64decode(v.wasm_src))}if(!this.__cache[c]){var m={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[c]=new WebAssembly.Instance(this.__wasm[c],{env:a(m,d||{})})}return this.__cache[c]},l.prototype.__align=function(c,u){u=u||8;var d=c%u;return c+(d?u-d:0)},r.exports=l},{"./lib/base64decode":21,"./lib/wa_detect":22,"object-assign":23}],21:[function(n,r,i){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";r.exports=function(o){for(var f=o.replace(/[\r\n=]/g,""),l=f.length,h=new Uint8Array(l*3>>2),c=0,u=0,d=0;d<l;d++)d%4==0&&d&&(h[u++]=c>>16&255,h[u++]=c>>8&255,h[u++]=c&255),c=c<<6|a.indexOf(f.charAt(d));var v=l%4*6;return v===0?(h[u++]=c>>16&255,h[u++]=c>>8&255,h[u++]=c&255):v===18?(h[u++]=c>>10&255,h[u++]=c>>2&255):v===12&&(h[u++]=c>>4&255),h}},{}],22:[function(n,r,i){var a;r.exports=function(){if(typeof a!="undefined"||(a=!1,typeof WebAssembly=="undefined"))return a;try{var o=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),f=new WebAssembly.Module(o),l=new WebAssembly.Instance(f,{});return l.exports.test(4)!==0&&(a=!0),a}catch(h){}return a}},{}],23:[function(n,r,i){var a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function f(h){if(h==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(h)}function l(){try{if(!Object.assign)return!1;var h=new String("abc");if(h[5]="de",Object.getOwnPropertyNames(h)[0]==="5")return!1;for(var c={},u=0;u<10;u++)c["_"+String.fromCharCode(u)]=u;var d=Object.getOwnPropertyNames(c).map(function(m){return c[m]});if(d.join("")!=="0123456789")return!1;var v={};return"abcdefghijklmnopqrst".split("").forEach(function(m){v[m]=m}),Object.keys(Object.assign({},v)).join("")==="abcdefghijklmnopqrst"}catch(m){return!1}}r.exports=l()?Object.assign:function(h,c){for(var u,d=f(h),v,m=1;m<arguments.length;m++){u=Object(arguments[m]);for(var p in u)s.call(u,p)&&(d[p]=u[p]);if(a){v=a(u);for(var w=0;w<v.length;w++)o.call(u,v[w])&&(d[v[w]]=u[v[w]])}}return d}},{}],24:[function(n,r,i){var a=arguments[3],s=arguments[4],o=arguments[5],f=JSON.stringify;r.exports=function(l,h){for(var c,u=Object.keys(o),d=0,v=u.length;d<v;d++){var m=u[d],p=o[m].exports;if(p===l||p&&p.default===l){c=m;break}}if(!c){c=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var w={},d=0,v=u.length;d<v;d++){var m=u[d];w[m]=m}s[c]=["function(require,module,exports){"+l+"(self); }",w]}var M=Math.floor(Math.pow(16,8)*Math.random()).toString(16),I={};I[c]=c,s[M]=["function(require,module,exports){var f = require("+f(c)+");(f.default ? f.default : f)(self);}",I];var x={};_(M);function _($){x[$]=!0;for(var L in s[$][1]){var C=s[$][1][L];x[C]||_(C)}}var E="("+a+")({"+Object.keys(x).map(function($){return f($)+":["+s[$][0]+","+f(s[$][1])+"]"}).join(",")+"},{},["+f(M)+"])",F=window.URL||window.webkitURL||window.mozURL||window.msURL,R=new Blob([E],{type:"text/javascript"});if(h&&h.bare)return R;var S=F.createObjectURL(R),N=new Worker(S);return N.objectURL=S,N}},{}],"/index.js":[function(n,r,i){function a(g,y){return h(g)||l(g,y)||o(g,y)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(g,y){if(!!g){if(typeof g=="string")return f(g,y);var b=Object.prototype.toString.call(g).slice(8,-1);if(b==="Object"&&g.constructor&&(b=g.constructor.name),b==="Map"||b==="Set")return Array.from(g);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return f(g,y)}}function f(g,y){(y==null||y>g.length)&&(y=g.length);for(var b=0,B=new Array(y);b<y;b++)B[b]=g[b];return B}function l(g,y){var b=g==null?null:typeof Symbol!="undefined"&&g[Symbol.iterator]||g["@@iterator"];if(b!=null){var B=[],k=!0,z=!1,T,D;try{for(b=b.call(g);!(k=(T=b.next()).done)&&(B.push(T.value),!(y&&B.length===y));k=!0);}catch(P){z=!0,D=P}finally{try{!k&&b.return!=null&&b.return()}finally{if(z)throw D}}return B}}function h(g){if(Array.isArray(g))return g}var c=n("object-assign"),u=n("webworkify"),d=n("./lib/mathlib"),v=n("./lib/pool"),m=n("./lib/utils"),p=n("./lib/worker"),w=n("./lib/stepper"),M=n("./lib/tiler"),I={},x=!1;try{typeof navigator!="undefined"&&navigator.userAgent&&(x=navigator.userAgent.indexOf("Safari")>=0)}catch(g){}var _=1;typeof navigator!="undefined"&&(_=Math.min(navigator.hardwareConcurrency||1,4));var E={tile:1024,concurrency:_,features:["js","wasm","ww"],idle:2e3,createCanvas:function(y,b){var B=document.createElement("canvas");return B.width=y,B.height=b,B}},F={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},R=!1,S=!1,N=!1,$=!1,L=!1;function C(){return{value:u(p),destroy:function(){if(this.value.terminate(),typeof window!="undefined"){var y=window.URL||window.webkitURL||window.mozURL||window.msURL;y&&y.revokeObjectURL&&this.value.objectURL&&y.revokeObjectURL(this.value.objectURL)}}}}function A(g){if(!(this instanceof A))return new A(g);this.options=c({},E,g||{});var y="lk_".concat(this.options.concurrency);this.__limit=I[y]||m.limiter(this.options.concurrency),I[y]||(I[y]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}A.prototype.init=function(){var g=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData!="undefined"&&typeof Uint8ClampedArray!="undefined")try{new ImageData(new Uint8ClampedArray(400),10,10),R=!0}catch(P){}typeof ImageBitmap!="undefined"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?S=!0:this.debug("ImageBitmap does not support .close(), disabled"));var y=this.options.features.slice();if(y.indexOf("all")>=0&&(y=["cib","wasm","js","ww"]),this.__requested_features=y,this.__mathlib=new d(y),y.indexOf("ww")>=0&&typeof window!="undefined"&&"Worker"in window)try{var b=n("webworkify")(function(){});b.terminate(),this.features.ww=!0;var B="wp_".concat(JSON.stringify(this.options));I[B]?this.__workersPool=I[B]:(this.__workersPool=new v(C,this.options.idle),I[B]=this.__workersPool)}catch(P){}var k=this.__mathlib.init().then(function(P){c(g.features,P.features)}),z;S?z=m.cib_support(this.options.createCanvas).then(function(P){if(g.features.cib&&y.indexOf("cib")<0){g.debug("createImageBitmap() resize supported, but disabled by config");return}y.indexOf("cib")>=0&&(g.features.cib=P)}):z=Promise.resolve(!1),N=m.can_use_canvas(this.options.createCanvas);var T;S&&R&&y.indexOf("ww")!==-1?T=m.worker_offscreen_canvas_support():T=Promise.resolve(!1),T=T.then(function(P){$=P});var D=m.cib_can_use_region().then(function(P){L=P});return this.__initPromise=Promise.all([k,z,T,D]).then(function(){return g}),this.__initPromise},A.prototype.__invokeResize=function(g,y){var b=this;return y.__mathCache=y.__mathCache||{},Promise.resolve().then(function(){return b.features.ww?new Promise(function(B,k){var z=b.__workersPool.acquire();y.cancelToken&&y.cancelToken.catch(function(D){return k(D)}),z.value.onmessage=function(D){z.release(),D.data.err?k(D.data.err):B(D.data)};var T=[];g.src&&T.push(g.src.buffer),g.srcBitmap&&T.push(g.srcBitmap),z.value.postMessage({opts:g,features:b.__requested_features,preload:{wasm_nodule:b.__mathlib.__}},T)}):{data:b.__mathlib.resizeAndUnsharp(g,y.__mathCache)}})},A.prototype.__extractTileData=function(g,y,b,B,k){if(this.features.ww&&$&&(m.isCanvas(y)||L))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(B.srcImageBitmap||y,g.x,g.y,g.width,g.height).then(function(D){return k.srcBitmap=D,k});if(m.isCanvas(y))return B.srcCtx||(B.srcCtx=y.getContext("2d",{alpha:Boolean(b.alpha)})),this.debug("Get tile pixel data"),k.src=B.srcCtx.getImageData(g.x,g.y,g.width,g.height).data,k;this.debug("Draw tile imageBitmap/image to temporary canvas");var z=this.options.createCanvas(g.width,g.height),T=z.getContext("2d",{alpha:Boolean(b.alpha)});return T.globalCompositeOperation="copy",T.drawImage(B.srcImageBitmap||y,g.x,g.y,g.width,g.height,0,0,g.width,g.height),this.debug("Get tile pixel data"),k.src=T.getImageData(0,0,g.width,g.height).data,z.width=z.height=0,k},A.prototype.__landTileData=function(g,y,b){var B;if(this.debug("Convert raw rgba tile result to ImageData"),y.bitmap)return b.toCtx.drawImage(y.bitmap,g.toX,g.toY),null;if(R)B=new ImageData(new Uint8ClampedArray(y.data),g.toWidth,g.toHeight);else if(B=b.toCtx.createImageData(g.toWidth,g.toHeight),B.data.set)B.data.set(y.data);else for(var k=B.data.length-1;k>=0;k--)B.data[k]=y.data[k];return this.debug("Draw tile"),x?b.toCtx.putImageData(B,g.toX,g.toY,g.toInnerX-g.toX,g.toInnerY-g.toY,g.toInnerWidth+1e-5,g.toInnerHeight+1e-5):b.toCtx.putImageData(B,g.toX,g.toY,g.toInnerX-g.toX,g.toInnerY-g.toY,g.toInnerWidth,g.toInnerHeight),null},A.prototype.__tileAndResize=function(g,y,b){var B=this,k={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},z=function(D){return B.__limit(function(){if(b.canceled)return b.cancelToken;var P={width:D.width,height:D.height,toWidth:D.toWidth,toHeight:D.toHeight,scaleX:D.scaleX,scaleY:D.scaleY,offsetX:D.offsetX,offsetY:D.offsetY,quality:b.quality,alpha:b.alpha,unsharpAmount:b.unsharpAmount,unsharpRadius:b.unsharpRadius,unsharpThreshold:b.unsharpThreshold};return B.debug("Invoke resize math"),Promise.resolve(P).then(function(Q){return B.__extractTileData(D,g,b,k,Q)}).then(function(Q){return B.debug("Invoke resize math"),B.__invokeResize(Q,b)}).then(function(Q){return b.canceled?b.cancelToken:(k.srcImageData=null,B.__landTileData(D,Q,k))})})};return Promise.resolve().then(function(){if(k.toCtx=y.getContext("2d",{alpha:Boolean(b.alpha)}),m.isCanvas(g))return null;if(m.isImageBitmap(g))return k.srcImageBitmap=g,k.isImageBitmapReused=!0,null;if(m.isImage(g))return S?(B.debug("Decode image via createImageBitmap"),createImageBitmap(g).then(function(T){k.srcImageBitmap=T}).catch(function(T){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(b.canceled)return b.cancelToken;B.debug("Calculate tiles");var T=M({width:b.width,height:b.height,srcTileSize:B.options.tile,toWidth:b.toWidth,toHeight:b.toHeight,destTileBorder:b.__destTileBorder}),D=T.map(function(Q){return z(Q)});function P(Q){Q.srcImageBitmap&&(Q.isImageBitmapReused||Q.srcImageBitmap.close(),Q.srcImageBitmap=null)}return B.debug("Process tiles"),Promise.all(D).then(function(){return B.debug("Finished!"),P(k),y},function(Q){throw P(k),Q})})},A.prototype.__processStages=function(g,y,b,B){var k=this;if(B.canceled)return B.cancelToken;var z=g.shift(),T=a(z,2),D=T[0],P=T[1],Q=g.length===0;B=c({},B,{toWidth:D,toHeight:P,quality:Q?B.quality:Math.min(1,B.quality)});var j;return Q||(j=this.options.createCanvas(D,P)),this.__tileAndResize(y,Q?b:j,B).then(function(){return Q?b:(B.width=D,B.height=P,k.__processStages(g,j,b,B))}).then(function(J){return j&&(j.width=j.height=0),J})},A.prototype.__resizeViaCreateImageBitmap=function(g,y,b){var B=this,k=y.getContext("2d",{alpha:Boolean(b.alpha)});return this.debug("Resize via createImageBitmap()"),createImageBitmap(g,{resizeWidth:b.toWidth,resizeHeight:b.toHeight,resizeQuality:m.cib_quality_name(b.quality)}).then(function(z){if(b.canceled)return b.cancelToken;if(!b.unsharpAmount)return k.drawImage(z,0,0),z.close(),k=null,B.debug("Finished!"),y;B.debug("Unsharp result");var T=B.options.createCanvas(b.toWidth,b.toHeight),D=T.getContext("2d",{alpha:Boolean(b.alpha)});D.drawImage(z,0,0),z.close();var P=D.getImageData(0,0,b.toWidth,b.toHeight);return B.__mathlib.unsharp_mask(P.data,b.toWidth,b.toHeight,b.unsharpAmount,b.unsharpRadius,b.unsharpThreshold),k.putImageData(P,0,0),T.width=T.height=0,P=D=T=k=null,B.debug("Finished!"),y})},A.prototype.resize=function(g,y,b){var B=this;this.debug("Start resize...");var k=c({},F);if(isNaN(b)?b&&(k=c(k,b)):k=c(k,{quality:b}),k.toWidth=y.width,k.toHeight=y.height,k.width=g.naturalWidth||g.width,k.height=g.naturalHeight||g.height,y.width===0||y.height===0)return Promise.reject(new Error("Invalid output size: ".concat(y.width,"x").concat(y.height)));k.unsharpRadius>2&&(k.unsharpRadius=2),k.canceled=!1,k.cancelToken&&(k.cancelToken=k.cancelToken.then(function(T){throw k.canceled=!0,T},function(T){throw k.canceled=!0,T}));var z=3;return k.__destTileBorder=Math.ceil(Math.max(z,2.5*k.unsharpRadius|0)),this.init().then(function(){if(k.canceled)return k.cancelToken;if(B.features.cib)return B.__resizeViaCreateImageBitmap(g,y,k);if(!N){var T=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw T.code="ERR_GET_IMAGE_DATA",T}var D=w(k.width,k.height,k.toWidth,k.toHeight,B.options.tile,k.__destTileBorder);return B.__processStages(D,g,y,k)})},A.prototype.resizeBuffer=function(g){var y=this,b=c({},F,g);return this.init().then(function(){return y.__mathlib.resizeAndUnsharp(b)})},A.prototype.toBlob=function(g,y,b){return y=y||"image/png",new Promise(function(B){if(g.toBlob){g.toBlob(function(P){return B(P)},y,b);return}if(g.convertToBlob){B(g.convertToBlob({type:y,quality:b}));return}for(var k=atob(g.toDataURL(y,b).split(",")[1]),z=k.length,T=new Uint8Array(z),D=0;D<z;D++)T[D]=k.charCodeAt(D);B(new Blob([T],{type:y}))})},A.prototype.debug=function(){},r.exports=A},{"./lib/mathlib":1,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":23,webworkify:24}]},{},[])("/index.js")})}),$r=gf;console.log("IMPORTING");var pf=function(){importScripts("https://cdn.jsdelivr.net/npm/d3-dispatch@3"),importScripts("https://cdn.jsdelivr.net/npm/d3-quadtree@3"),importScripts("https://cdn.jsdelivr.net/npm/d3-timer@3"),importScripts("https://cdn.jsdelivr.net/npm/d3-force@3"),importScripts("https://unpkg.com/d3-binarytree"),importScripts("https://unpkg.com/d3-octree"),importScripts("https://unpkg.com/d3-force-3d"),self.onmessage=function(e){console.log("RECEIVED:",e.data.type);let t=!1;if(e.data.type=="import")console.log("IMPORTING...");else if(e.data.type=="stop")this.simulation.stop();else if(e.data.type=="restart")this.simulation.restart();else if(e.data.type=="init"){console.log("INIT");let n=e.data.network;e.data.use2D&&(t=!0);let r=[],i=[];Object.entries(n.nodes).forEach(a=>{let[s,o]=a;o.ID=s,o.x=400*(Math.random()*1-.5),o.y=400*(Math.random()*1-.5),o.z=400*(Math.random()*1-.5),o.vz=0,o.index=n.ID2index[s],r.push(o)});for(let a=0;a<n.indexedEdges.length/2;a++){let s=n.indexedEdges[a*2],o=n.indexedEdges[a*2+1],f={source:s,target:o};i.push(f)}this.simulation=d3.forceSimulation(r).numDimensions(t?2:3).force("charge",d3.forceManyBody()).force("link",d3.forceLink(i)).force("center",d3.forceCenter()).velocityDecay(.05).on("tick",async()=>{for(let a=0;a<r.length;a++){let s=r[a];n.positions[a*3+0]=s.x/10,n.positions[a*3+1]=s.y/10,t?n.positions[a*3+2]=0:n.positions[a*3+2]=s.z/10}self.postMessage({type:"layoutStep",positions:n.positions})})}}},zr=pf.toString();console.log(zr);var Tr=URL.createObjectURL(new Blob([`(${zr})()`],{type:"text/javascript"}));import.meta.env=Ee;var mf=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),qt=class{constructor({elementID:t,nodes:n={},edges:r=[],use2D:i=!1,display:a=[]}){if(this.element=document.getElementById(t),this.element.innerHTML="",this.canvasElement=document.createElement("canvas"),this.element.appendChild(this.canvasElement),this.network=new mt(n,r),this.display=a,this.rotationMatrix=G.create(),this.translatePosition=ln.create(),this.mouseDown=!1,this.lastMouseX=null,this.lastMouseY=null,this.redrawingFromMouseWheelEvent=!1,this.fastEdges=!1,this.animate=!1,this.cameraDistance=450,this.zoomFactor=1,this.rotateLinearX=0,this.rotateLinearY=0,this.panX=0,this.panY=0,this.saveResolutionRatio=1,this.pickingResolutionRatio=.25,this._edgesIntensity=1,this._use2D=i,this._use2D)for(let o=0;o<this.network.positions.length;o++)this.network.positions[o*3+2]=0;G.identity(this.rotationMatrix);var s=[0,0,0];this.gl=mn(this.canvasElement,{antialias:!0,powerPreference:"high-performance",desynchronized:!0}),console.log(this.gl),this.initialize(),window.onresize=o=>{this.willResizeEvent(o)},this.onNodeClickCallback=null,this.onNodeHoverStartCallback=null,this.onNodeHoverMoveCallback=null,this.onNodeHoverEndCallback=null,this.onZoomCallback=null,this.onRotationCallback=null,this.onResizeCallback=null,this.onLayoutStartCallback=null,this.onLayoutFinishCallback=null,this.onDrawCallback=null,this._backgroundColor=[.5,.5,.5,1],this.onReadyCallback=null,this.isReady=!1}async initialize(){await this._setupShaders(),await this._buildGeometry(),await this._buildPickingBuffers(),await this._buildEdgesGeometry(),await this.willResizeEvent(0),await this._setupCamera(),await this._setupEvents(),await this._setupLayout(),await this.redraw(),this.onReadyCallback?.(this),this.onReadyCallback=null,this.isReady=!0}_setupLayout(){this.layoutWorker=new Worker(Tr),this.newPositions=this.network.positions.slice(0),this.positionInterpolator=null,this.layoutWorker.onmessage=t=>{if(t.data.type=="layoutStep"){if(this.newPositions=t.data.positions,this.positionInterpolator==null){let n=0;for(let r=0;r<this.network.positions.length;r++){let i=this.newPositions[r]-this.network.positions[r];n=Math.max(Math.abs(i),n)}n>1&&(this.onLayoutStartCallback?.(),this.positionInterpolator=setInterval(()=>{let r=0;for(let i=0;i<this.network.positions.length;i++){let a=this.newPositions[i]-this.network.positions[i];this.network.positions[i]+=.025*a,r=Math.max(Math.abs(a),r)}this._updateGeometry(),this._updateEdgesGeometry(),requestAnimationFrame(()=>{this.redraw()}),r<1&&(this.onLayoutFinishCallback?.(),clearInterval(this.positionInterpolator),this.positionInterpolator=null)},1e3/60))}}else console.log("Received message",t)},this.layoutWorker.postMessage({type:"import",location:import.meta.url}),this.layoutWorker.postMessage({type:"init",network:this.network,use2D:this._use2D}),this.layoutRunning=!0,document.addEventListener("keyup",t=>{t.code==="Space"&&(this.layoutRunning?(this.layoutWorker.postMessage({type:"stop"}),this.layoutRunning=!1):(this.layoutWorker.postMessage({type:"restart"}),this.layoutRunning=!0))})}_setupEvents(){this.lastMouseX=-1,this.lastMouseY=-1,this.currentHoverIndex=-1,this.canvasElement.onclick=t=>{let n=this.canvasElement.getBoundingClientRect();this.lastMouseX=t.clientX,this.lastMouseY=t.clientY;let r=this.pickPoint(this.lastMouseX-n.left,this.lastMouseY-n.top);r>=0&&this.onNodeClickCallback?.(this.network.index2Node[r],t)},this.canvasElement.addEventListener("mousemove",t=>{this.lastMouseX=t.clientX,this.lastMouseY=t.clientY,this.triggerHoverEvents(t)}),this.canvasElement.addEventListener("mouseleave",t=>{this.currentHoverIndex>=0&&(this.onNodeHoverEndCallback?.(this.network.index2Node[this.currentHoverIndex],t),this.currentHoverIndex=-1,this.lastMouseX=-1,this.lastMouseY=-1)}),document.body.addEventListener("mouseout",t=>{!t.relatedTarget&&!t.toElement&&this.currentHoverIndex>=0&&(this.onNodeHoverEndCallback?.(this.network.index2Node[this.currentHoverIndex],t),this.currentHoverIndex=-1,this.lastMouseX=-1,this.lastMouseY=-1)})}async _downloadImageData(t,n,r,i){let a=new $r({}),s=document.createElement("canvas"),o=document.createElement("canvas"),f=s.getContext("2d"),l=o.getContext("2d");o.width=t.width,o.height=t.height,s.width=t.width/r,s.height=t.height/r,f.imageSmoothingEnabled=!0,l.imageSmoothingEnabled=!0,typeof f.imageSmoothingQuality!="undefined"&&(f.imageSmoothingQuality="high"),typeof l.imageSmoothingQuality!="undefined"&&(l.imageSmoothingQuality="high"),l.putImageData(t,0,0),await a.resize(o,s,{alpha:!0});let h=document.createElement("a");mf&&(console.log("Fixing Safari bug..."),s.toDataURL()),h.setAttribute("download",n);let c=await a.toBlob(s,"image/png");if(c)if(n.endsWith("svg")){let u=`
				<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
				width="${s.width}" height="${s.width}"
				>
				<image
						width="${s.width}" height="${s.width}"
						xlink:href="${c}"
						/>
				</svg>`;h.setAttribute("download",n);let d=new Blob([u],{type:"image/svg+xml"}),v=URL.createObjectURL(d);h.setAttribute("href",v),h.click()}else{let u=URL.createObjectURL(c);h.setAttribute("href",u),h.click()}else window.alert("An error occured while trying to download the image. Please try again. (Error: blob is null.)");if(n.endsWith("svg")){let u=`
			<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
			width="${s.width}" height="${s.width}"
			>
			<image
					width="${s.width}" height="${s.width}"
					xlink:href="${s.toDataURL()}"
					/>
			</svg>`;h.setAttribute("download",n);let d=new Blob([u],{type:"image/svg+xml"}),v=URL.createObjectURL(d);h.setAttribute("href",v),h.click()}}framebufferImage(t){let n=t.size.width,r=t.size.height,i=new Uint8ClampedArray(4*n*r),a=this.gl;return a.bindFramebuffer(a.FRAMEBUFFER,t),a.readPixels(0,0,n,r,a.RGBA,a.UNSIGNED_BYTE,i),new ImageData(i,n,r)}exportFigure(t,{scale:n=1,supersampleFactor:r=4,width:i=null,height:a=null,backgroundColor:s=null}){typeof n=="undefined"&&(n=1),typeof r=="undefined"&&(r=2);let o=this.createOffscreenFramebuffer();i==null&&a==null?(i=this.canvasElement.width,a=this.canvasElement.height):i==null?i=Math.round(a*this.canvasElement.width/this.canvasElement.height):a==null&&(a=Math.round(i*this.canvasElement.height/this.canvasElement.width)),s==null&&(s=this.backgroundColor),o.setSize(i*n*r,a*n*r),o.backgroundColor=s,this._redrawAll(o);let f=this.framebufferImage(o);this._downloadImageData(f,t,r),o.discard()}triggerHoverEvents(t){if(this.lastMouseX==-1||this.lastMouseY==-1)return;let n=this.canvasElement.getBoundingClientRect(),r=this.pickPoint(this.lastMouseX-n.left,this.lastMouseY-n.top);r>=0&&this.currentHoverIndex==-1?(this.currentHoverIndex=r,this.onNodeHoverStartCallback?.(this.network.index2Node[r],t)):r>=0&&this.currentHoverIndex==r?this.onNodeHoverMoveCallback?.(this.network.index2Node[r],t):r>=0&&this.currentHoverIndex!=r?(this.onNodeHoverEndCallback?.(this.network.index2Node[this.currentHoverIndex],t),this.currentHoverIndex=r,this.onNodeHoverStartCallback?.(this.network.index2Node[r],t)):r==-1&&this.currentHoverIndex!=r&&(this.onNodeHoverEndCallback?.(this.network.index2Node[this.currentHoverIndex],t),this.currentHoverIndex=-1)}async _setupShaders(){let t=await ye(this.gl,"edges-vertex"),n=await ye(this.gl,"edges-fragment");this.edgesShaderProgram=new Pe(t,n,["projectionViewMatrix","nearFar","linesIntensity"],["vertex","color"],this.gl);let r=await ye(this.gl,"vertices-vertex"),i=await ye(this.gl,"vertices-fragment"),a=await ye(this.gl,"vertices-fragment-picking");this.verticesShaderProgram=new Pe(r,i,["viewMatrix","projectionMatrix","normalMatrix"],["vertex","position","color","intensity","size","outlineWidth","outlineColor","encodedIndex"],this.gl),this.verticesPickingShaderProgram=new Pe(r,a,["viewMatrix","projectionMatrix","normalMatrix"],["vertex","position","color","intensity","size","outlineWidth","outlineColor","encodedIndex"],this.gl)}async _buildGeometry(){let t=this.gl,n=15;this.nodesGeometry=An(t,!1,!1),this.nodesPositionBuffer=t.createBuffer(),this.nodesColorBuffer=t.createBuffer(),this.nodesSizeBuffer=t.createBuffer(),this.nodesIntensityBuffer=t.createBuffer(),this.nodesOutlineWidthBuffer=t.createBuffer(),this.nodesOutlineColorBuffer=t.createBuffer(),this.nodesIndexBuffer=t.createBuffer(),this.nodesIndexArray=new Float32Array(this.network.index2Node.length*4);for(let r=0;r<this.network.index2Node.length;r++)this.nodesIndexArray[4*r]=(r+1>>0&255)/255,this.nodesIndexArray[4*r+1]=(r+1>>8&255)/255,this.nodesIndexArray[4*r+2]=(r+1>>16&255)/255,this.nodesIndexArray[4*r+3]=(r+1>>24&255)/255;t.bindBuffer(t.ARRAY_BUFFER,this.nodesIndexBuffer),t.bufferData(t.ARRAY_BUFFER,this.nodesIndexArray,t.STATIC_DRAW),console.log(this.nodesIndexArray),await this._updateGeometry()}async _buildPickingBuffers(){let t=this.gl;this.pickingFramebuffer=this.createOffscreenFramebuffer()}createOffscreenFramebuffer(){let t=this.gl,n=t.createFramebuffer();n.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,n.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n.depthBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,n.depthBuffer),t.bindFramebuffer(t.FRAMEBUFFER,n),n.size={width:0,height:0},n.setSize=(a,s)=>{t.bindTexture(t.TEXTURE_2D,n.texture);let o=0,f=t.RGBA,l=0,h=t.RGBA,c=t.UNSIGNED_BYTE,u=null,d=a,v=s;t.texImage2D(t.TEXTURE_2D,o,f,d,v,l,h,c,u),t.bindRenderbuffer(t.RENDERBUFFER,n.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,d,v),n.size.width=a,n.size.height=s},n.discard=()=>{t.deleteRenderbuffer(n.depthBuffer),t.deleteTexture(n.texture),t.deleteFramebuffer(n)};let r=t.COLOR_ATTACHMENT0,i=0;return t.framebufferTexture2D(t.FRAMEBUFFER,r,t.TEXTURE_2D,n.texture,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n.depthBuffer),n}async _updateGeometry(){let t=this.gl,n=this.network.positions;t.bindBuffer(t.ARRAY_BUFFER,this.nodesPositionBuffer),t.bufferData(t.ARRAY_BUFFER,n,t.DYNAMIC_DRAW);let r=this.network.colors;t.bindBuffer(t.ARRAY_BUFFER,this.nodesColorBuffer),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW);let i=this.network.sizes;t.bindBuffer(t.ARRAY_BUFFER,this.nodesSizeBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW);let a=this.network.intensities;t.bindBuffer(t.ARRAY_BUFFER,this.nodesIntensityBuffer),t.bufferData(t.ARRAY_BUFFER,a,t.STATIC_DRAW);let s=this.network.outlineWidths;t.bindBuffer(t.ARRAY_BUFFER,this.nodesOutlineWidthBuffer),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW);let o=this.network.outlineColors;t.bindBuffer(t.ARRAY_BUFFER,this.nodesOutlineColorBuffer),t.bufferData(t.ARRAY_BUFFER,o,t.STATIC_DRAW)}async _buildEdgesGeometry(){let t=this.gl,n=this.network.indexedEdges,r=this.network.positions,i=this.network.colors,a=new Object,s;if(r.length<64e3)s=new Uint16Array(n),a.indexType=t.UNSIGNED_SHORT;else{var o=t.getExtension("OES_element_index_uint");o==null?(s=new Uint16Array(n),a.indexType=t.UNSIGNED_SHORT):(s=new Uint32Array(n),a.indexType=t.UNSIGNED_INT)}a.vertexObject=t.createBuffer(),a.colorObject=t.createBuffer(),a.numIndices=s.length,a.indexObject=t.createBuffer(),this.edgesGeometry=a,this.indicesArray=s,await this._updateEdgesGeometry()}async _updateEdgesGeometry(){let t=this.gl,n=this.network.indexedEdges,r=this.network.positions,i=this.network.colors;t.bindBuffer(t.ARRAY_BUFFER,this.edgesGeometry.vertexObject),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.edgesGeometry.colorObject),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.edgesGeometry.indexObject),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indicesArray,t.STREAM_DRAW)}async resizeGL(t,n){this.pickingFramebuffer.setSize(t*this.pickingResolutionRatio,n*this.pickingResolutionRatio),window.requestAnimationFrame(()=>this.redraw())}async _setupCamera(){this.zoom=sr().on("zoom",t=>{this.zoomFactor=t.transform.k,this.triggerHoverEvents(t),this.positionInterpolator||(this.update(),this.render())}),this.drag=or().on("drag",t=>{let n=G.create();if(!this._use2D)G.identity(n),G.rotate(n,n,At(t.dx/2),[0,1,0]),G.rotate(n,n,At(t.dy/2),[1,0,0]),G.multiply(this.rotationMatrix,n,this.rotationMatrix);else{let r=this.cameraDistance*this.zoomFactor,i=this.canvasElement.width/this.canvasElement.height;this.panX=this.panX+t.dx/r*400,this.panY=this.panY-t.dy/r*400}this.positionInterpolator||(this.update(),this.render()),this.triggerHoverEvents(t)}),H(this.canvasElement).call(this.drag).call(this.zoom).on("dblclick.zoom",null)}willResizeEvent(t){let n=window.devicePixelRatio||1;this.canvasElement.style.width=this.element.clientWidth+"px",this.canvasElement.style.height=this.element.clientHeight+"px",this.canvasElement.width=n*this.element.clientWidth,this.canvasElement.height=n*this.element.clientHeight,this.resizeGL(this.canvasElement.width,this.canvasElement.height),this.onResizeCallback?.(t)}redraw(){this._redrawAll(null,!1),this._redrawAll(this.pickingFramebuffer,!0),this.onDrawCallback?.(),this.triggerHoverEvents(null)}update(){this.positionInterpolator||(this._updateGeometry(),this._updateEdgesGeometry())}render(){this.positionInterpolator||window.requestAnimationFrame(()=>this.redraw())}_redrawPrepare(t,n,r){let i=this.gl,a=t?.size.width||this.canvasElement.width,s=t?.size.height||this.canvasElement.height;t==null?(i.bindFramebuffer(i.FRAMEBUFFER,null),i.clearColor(...this._backgroundColor)):n?(i.bindFramebuffer(i.FRAMEBUFFER,t),i.clearColor(0,0,0,0)):(i.bindFramebuffer(i.FRAMEBUFFER,t),typeof t.backgroundColor=="undefined"?i.clearColor(...this._backgroundColor):i.clearColor(...t.backgroundColor)),typeof r=="undefined"?i.viewport(0,0,a,s):i.viewport(...r),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.depthFunc(i.LEQUAL),this.projectionMatrix=G.create(),this.viewMatrix=G.create(),G.perspective(this.projectionMatrix,Math.PI*2/360*70,a/s,1,3e3),G.identity(this.viewMatrix),G.translate(this.viewMatrix,this.viewMatrix,[this.panX,this.panY,-this.cameraDistance/this.zoomFactor]),G.multiply(this.viewMatrix,this.viewMatrix,this.rotationMatrix),G.translate(this.viewMatrix,this.viewMatrix,this.translatePosition)}_redrawNodes(t,n){let r=this.gl,i=r.getExtension("ANGLE_instanced_arrays"),a;n?(r.disable(r.BLEND),a=this.verticesPickingShaderProgram):(r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),a=this.verticesShaderProgram),a.use(r),a.attributes.enable("vertex"),a.attributes.enable("position"),a.attributes.enable("size"),a.attributes.enable("intensity"),a.attributes.enable("outlineWidth"),a.attributes.enable("outlineColor"),a.attributes.enable("encodedIndex"),r.bindBuffer(r.ARRAY_BUFFER,this.nodesGeometry.vertexObject),r.vertexAttribPointer(a.attributes.vertex,3,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.vertex,0),this.nodesGeometry.indexObject&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.nodesGeometry.indexObject),r.uniformMatrix4fv(a.uniforms.projectionMatrix,!1,this.projectionMatrix),r.uniformMatrix4fv(a.uniforms.viewMatrix,!1,this.viewMatrix);let s=ct.create();ct.normalFromMat4(s,this.viewMatrix),r.uniformMatrix3fv(a.uniforms.normalMatrix,!1,s);let o=this.network.colors,f=this.network.positions,l=this.network.sizes,h=this.network.intensities,c=this.network.outlineWidths;r.bindBuffer(r.ARRAY_BUFFER,this.nodesPositionBuffer),r.enableVertexAttribArray(a.attributes.position),r.vertexAttribPointer(a.attributes.position,3,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.position,1),r.bindBuffer(r.ARRAY_BUFFER,this.nodesColorBuffer),r.enableVertexAttribArray(a.attributes.color),r.vertexAttribPointer(a.attributes.color,3,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.color,1),r.bindBuffer(r.ARRAY_BUFFER,this.nodesSizeBuffer),r.enableVertexAttribArray(a.attributes.size),r.vertexAttribPointer(a.attributes.size,1,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.size,1),r.bindBuffer(r.ARRAY_BUFFER,this.nodesOutlineColorBuffer),r.enableVertexAttribArray(a.attributes.outlineColor),r.vertexAttribPointer(a.attributes.outlineColor,3,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.outlineColor,1),r.bindBuffer(r.ARRAY_BUFFER,this.nodesOutlineWidthBuffer),r.enableVertexAttribArray(a.attributes.outlineWidth),r.vertexAttribPointer(a.attributes.outlineWidth,1,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.outlineWidth,1),r.bindBuffer(r.ARRAY_BUFFER,this.nodesIntensityBuffer),r.enableVertexAttribArray(a.attributes.intensity),r.vertexAttribPointer(a.attributes.intensity,1,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.intensity,1),r.bindBuffer(r.ARRAY_BUFFER,this.nodesIndexBuffer),r.enableVertexAttribArray(a.attributes.encodedIndex),r.vertexAttribPointer(a.attributes.encodedIndex,4,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(a.attributes.encodedIndex,1),this.nodesGeometry.indexObject?i.drawElementsInstancedANGLE(r.TRIANGLES,this.nodesGeometry.numIndices,this.nodesGeometry.indexType,0,this.network.positions.length/3):i.drawArraysInstancedANGLE(r.TRIANGLE_STRIP,0,this.nodesGeometry.numIndices,this.network.positions.length/3),a.attributes.disable("vertex"),a.attributes.disable("position"),a.attributes.disable("size"),a.attributes.disable("intensity"),a.attributes.disable("outlineWidth"),a.attributes.disable("outlineColor"),a.attributes.disable("encodedIndex")}_redrawEdges(t,n){let r=this.gl,i=r.getExtension("ANGLE_instanced_arrays");!n&&!((this.mouseDown||this.redrawingFromMouseWheelEvent)&&this.fastEdges)&&(this.edgesShaderProgram.use(r),this.edgesShaderProgram.attributes.enable("vertex"),this.edgesShaderProgram.attributes.enable("color"),r.enable(r.BLEND),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE),this.projectionViewMatrix=G.create(),G.multiply(this.projectionViewMatrix,this.projectionMatrix,this.viewMatrix),r.bindBuffer(r.ARRAY_BUFFER,this.edgesGeometry.vertexObject),r.vertexAttribPointer(this.edgesShaderProgram.attributes.vertex,3,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(this.edgesShaderProgram.attributes.vertex,0),r.bindBuffer(r.ARRAY_BUFFER,this.edgesGeometry.colorObject),r.vertexAttribPointer(this.edgesShaderProgram.attributes.color,3,r.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(this.edgesShaderProgram.attributes.color,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.edgesGeometry.indexObject),r.uniformMatrix4fv(this.edgesShaderProgram.uniforms.projectionViewMatrix,!1,this.projectionViewMatrix),r.uniform1f(this.edgesShaderProgram.uniforms.linesIntensity,this._edgesIntensity),r.drawElements(r.LINES,this.edgesGeometry.numIndices,this.edgesGeometry.indexType,0),this.edgesShaderProgram.attributes.disable("vertex"),this.edgesShaderProgram.attributes.disable("color"))}_redrawAll(t,n){typeof n=="undefined"&&(n=!1);let r=this.gl;this._redrawPrepare(t,n),r.depthMask(!0),this._use2D?(r.disable(r.DEPTH_TEST),r.depthMask(!1),this._redrawEdges(t,n),this._redrawNodes(t,n)):(r.enable(r.DEPTH_TEST),this._redrawNodes(t,n),r.depthMask(!1),this._redrawEdges(t,n),r.depthMask(!0))}onResize(t){return this.onResizeCallback=t,this}onNodeClick(t){return this.onNodeClickCallback=t,this}onNodeHoverStart(t){return this.onNodeHoverStartCallback=t,this}onNodeHoverEnd(t){return this.onNodeHoverEndCallback=t,this}onNodeHoverMove(t){return this.onNodeHoverMoveCallback=t,this}onZoom(t){return this.onZoomCallback=t,this}onRotation(t){return this.onRotationCallback=t,this}onLayoutStart(t){return this.onLayoutStartCallback=t,this}onLayoutFinish(t){return this.onLayoutFinishCallback=t,this}onDraw(t){return this.onDrawCallback=t,this}onReady(t){this.isReady?t?.(this):this.onReadyCallback=t}backgroundColor(t){return typeof t=="undefined"?this._backgroundColor:(this._backgroundColor=t,this)}nodeColor(t,n){if(typeof n=="undefined"){if(typeof t=="undefined")return this.network.colors;if(typeof t=="function")for(let[r,i]of Object.entries(this.network.nodes)){let a=this.network.ID2index[r],s=t(i,a,this.network);this.network.colors[a*3+0]=s[0],this.network.colors[a*3+1]=s[1],this.network.colors[a*3+2]=s[2]}else{if(typeof t=="number")return this.network.colors[this.network.ID2index[t]];for(let[r,i]of Object.entries(this.network.nodes)){let a=this.network.ID2index[r];this.network.colors[a*3+0]=t[0],this.network.colors[a*3+1]=t[1],this.network.colors[a*3+2]=t[2]}}}else if(typeof t=="function"){let r=this.network.ID2index[n],i=t(n,r,this.network);this.network.colors[r*3+0]=i[0],this.network.colors[r*3+1]=i[1],this.network.colors[r*3+2]=i[2]}else{let r=this.network.ID2index[n];this.network.colors[r*3+0]=t[0],this.network.colors[r*3+1]=t[1],this.network.colors[r*3+2]=t[2]}return this}nodeSize(t,n){if(typeof n=="undefined"){if(typeof t=="undefined")return this.network.sizes;if(typeof t=="function")for(let[r,i]of Object.entries(this.network.nodes)){let a=t(i,this.network);this.network.sizes[i.index]=a}else for(let[r,i]of Object.entries(this.network.nodes))this.network.sizes[i.index]=t}else if(typeof t=="function"){let r=t(n,this.network),i=this.network.ID2index[n];this.network.sizes[i]=r}else{let r=this.network.ID2index[n];this.network.sizes[r]=t}return this}nodeOutlineColor(t,n){if(typeof n=="undefined"){if(typeof t=="undefined")return this.network.outlineColors;if(typeof t=="function")for(let[r,i]of Object.entries(this.network.nodes)){let a=this.network.ID2index[r],s=t(i,a,this.network);this.network.outlineColors[a*3+0]=s[0],this.network.outlineColors[a*3+1]=s[1],this.network.outlineColors[a*3+2]=s[2]}else{if(typeof t=="number")return this.network.outlineColors[this.network.ID2index[t]];for(let[r,i]of Object.entries(this.network.nodes)){let a=this.network.ID2index[r];this.network.outlineColors[a*3+0]=t[0],this.network.outlineColors[a*3+1]=t[1],this.network.outlineColors[a*3+2]=t[2]}}}else if(typeof t=="function"){let r=this.network.ID2index[n],i=t(n,r,this.network);this.network.outlineColors[r*3+0]=i[0],this.network.outlineColors[r*3+1]=i[1],this.network.outlineColors[r*3+2]=i[2]}else{let r=this.network.ID2index[n];this.network.outlineColors[r*3+0]=t[0],this.network.outlineColors[r*3+1]=t[1],this.network.outlineColors[r*3+2]=t[2]}return this}nodeOutlineWidth(t,n){if(typeof n=="undefined"){if(typeof t=="undefined")return this.network.outlineWidths;if(typeof t=="function")for(let[r,i]of Object.entries(this.network.nodes)){let a=t(i,this.network);this.network.outlineWidths[i.index]=a}else for(let[r,i]of Object.entries(this.network.nodes))this.network.outlineWidths[i.index]=t}else if(typeof t=="function"){let r=t(n,this.network),i=this.network.ID2index[n];this.network.outlineWidths[i]=r}else{let r=this.network.ID2index[n];this.network.outlineWidths[r]=t}return this}pickPoint(t,n){let r=this.canvasElement.width*this.pickingResolutionRatio,i=this.canvasElement.height*this.pickingResolutionRatio,a=t*r/this.canvasElement.clientWidth,s=i-n*i/this.canvasElement.clientHeight-1,o=new Uint8Array(4),f=this.gl;return f.bindFramebuffer(f.FRAMEBUFFER,this.pickingFramebuffer),f.readPixels(a,s,1,1,f.RGBA,f.UNSIGNED_BYTE,o),o[0]+(o[1]<<8)+(o[2]<<16)+(o[3]<<24)-1}edgesIntensity(t){return typeof t=="undefined"?this._edgesIntensity:(this._edgesIntensity=t,this)}};export{qt as Helios,Qe as xnet};
/*!

pica
https://github.com/nodeca/pica

*/
//# sourceMappingURL=helios.js.map
